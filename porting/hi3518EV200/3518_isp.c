#include "hicommon.h"
#include <hi_sns_ctrl.h>
#include <jv_common.h>
#include "3518_isp.h"
#include "hi_spi.h"



#include <mpi_ae.h>
#include <mpi_awb.h>

#define I2C_16BIT_REG   0x0709  /* 16BIT REG WIDTH */
#define I2C_16BIT_DATA  0x070a  /* 16BIT DATA WIDTH */
#define I2C_SLAVE_FORCE 0x0706 


const HI_U16 V200_LINE_DAY_LV0_GAMMA[257] =
{
	0,57,116,175,234,294,354,413,473,531,589,647,703,757,810,862,911,959,1005,1051,1095,1138,1180,1221,1261,1300,1339,1376,1412,1447,1482,1515,1548,1580,1610,1639,1667,1693,1719,1744,1768,1792,1815,1837,1860,1882,1904,1926,1948,1970,1991,2012,2033,2053,2073,2092,2112,2131,2149,2168,2186,2205,2223,2242,2260,2278,2297,2315,2333,2351,2368,2386,2404,2421,2438,2455,2472,2489,2506,2523,2539,2555,2572,2588,2604,2620,2636,2652,2667,2683,2698,2713,2728,2743,2758,2772,2786,2800,2813,2827,2840,2852,2865,2878,\
	2890,2902,2914,2926,2938,2950,2962,2974,2986,2998,3009,3021,3032,3043,3055,3066,3077,3089,3101,3113,3125,3137,3149,3161,3172,3183,3194,3206,3216,3227,3238,3249,3259,3270,3280,3291,3301,3311,3321,3331,3341,3351,3361,3370,3380,3390,3399,3408,3418,3427,3436,3445,3454,3463,3472,3481,3490,3499,3507,3516,3525,3533,3542,3550,3558,3567,3575,3583,3591,3599,3607,3614,3622,3629,3637,3644,3651,3658,3665,3672,3679,3685,3692,3699,3705,3712,3719,3725,3732,3739,3746,3752,3759,3766,3773,3779,3786,3793,3799,\
	3806,3812,3819,3825,3832,3838,3844,3850,3856,3863,3869,3875,3881,3887,3893,3899,3905,3910,3916,3922,3928,3933,3939,3945,3950,3956,3962,3967,3973,3978,3983,3989,3994,3999,4005,4010,4015,4020,4026,4031,4036,4041,4046,4051,4056,4061,4066,4071,4076,4081,4085,4090,4095,4095
};

const HI_U16 V200_LINE_NIGHT_LV0_GAMMA[257] =
{
	0,45,90,135,181,226,272,318,363,408,453,498,542,585,628,670,711,751,791,830,868,906,944,981,1017,1054,1090,1125,1160,1196,1231,1265,1300,1335,1369,1404,1438,1472,1506,1540,1573,1606,1639,1670,1702,1732,1762,1792,1820,1848,1874,1900,1926,1951,1975,1998,2022,2044,2067,2089,2111,2132,2153,2175,2196,2217,2238,2258,2278,2298,2317,2337,2356,2374,2393,2411,2429,2447,2464,2482,2499,2516,2533,2549,2565,2581,2596,2612,2627,2642,2657,2672,2687,2701,2716,2731,2746,2761,2776,2791,2806,2821,2836,2851,2865,2880,\
	2894,2909,2923,2937,2951,2965,2978,2991,3004,3017,3030,3042,3055,3067,3079,3091,3103,3114,3126,3138,3149,3161,3172,3183,3194,3206,3216,3227,3238,3249,3259,3270,3280,3291,3301,3311,3321,3331,3341,3351,3361,3370,3380,3390,3399,3408,3418,3427,3436,3445,3454,3463,3472,3481,3490,3499,3507,3516,3525,3533,3542,3550,3558,3567,3575,3583,3591,3599,3607,3614,3622,3629,3637,3644,3651,3658,3665,3672,3679,3685,3692,3699,3705,3712,3719,3725,3732,3739,3746,3752,3759,3766,3773,3779,3786,3793,3799,3806,3812,\
	3819,3825,3832,3838,3844,3850,3856,3863,3869,3875,3881,3887,3893,3899,3905,3910,3916,3922,3928,3933,3939,3945,3950,3956,3962,3967,3973,3978,3983,3989,3994,3999,4005,4010,4015,4020,4026,4031,4036,4041,4046,4051,4056,4061,4066,4071,4076,4081,4085,4090,4095,4095
};

const HI_U16 V200_LINE_DAY_LV1_GAMMA[257]=
{
	0,68,138,209,281,353,426,498,570,640,710,777,843,907,967,1025,1079,1130,1178,1224,1267,1308,1348,1385,1421,1456,1489,1521,1553,1584,1615,1645,1676,1706,1735,1762,1789,1815,1839,1863,1887,1910,1932,1954,1975,1996,2018,2039,2060,2081,2102,2122,2141,2161,2180,2198,2217,2235,2252,2270,2288,2305,2322,2339,2356,2373,2390,2406,2422,2438,2454,2470,2486,2501,2516,2531,2546,2560,2575,2589,2603,2617,2630,2644,2657,2670,2682,2695,2707,2719,2731,2743,2755,2767,2779,2790,2802,2814,2825,2836,2848,2859,2870,2880,\
	2891,2902,2913,2924,2934,2945,2956,2967,2978,2989,3000,3011,3023,3034,3045,3057,3068,3079,3090,3102,3113,3124,3135,3145,3156,3167,3177,3188,3198,3208,3218,3229,3239,3249,3259,3269,3279,3288,3298,3308,3317,3326,3336,3345,3354,3363,3372,3381,3389,3398,3407,3415,3424,3432,3441,3449,3458,3466,3475,3483,3492,3500,3508,3516,3524,3533,3541,3549,3557,3565,3573,3582,3590,3598,3607,3615,3624,3632,3641,3650,3658,3667,3675,3684,3692,3700,3708,3716,3724,3732,3739,3747,3754,3761,3769,3776,3783,3790,3797,3804,\
	3811,3818,3824,3831,3838,3845,3852,3858,3865,3872,3878,3885,3892,3898,3905,3911,3917,3923,3929,3935,3941,3947,3952,3957,3963,3968,3973,3977,3982,3987,3992,3996,4001,4006,4010,4015,4020,4025,4030,4034,4039,4044,4048,4053,4058,4062,4067,4072,4076,4081,4086,4090,4095
};
const HI_U16 V200_LINE_DAY_LV2_GMMMA[257]=
{
	0, 180, 320, 426, 516, 590, 660, 730, 786, 844, 896, 946, 994, 1040, 1090, 1130, 1170, 1210, 1248,    1296, 1336, 1372, 1416, 1452, 1486, 1516, 1546, 1580, 1616, 1652, 1678, 1714, 1742, 1776, 1798, 1830,	1862, 1886, 1912, 1940, 1968, 1992, 2010, 2038, 2062, 2090, 2114, 2134, 2158, 2178, 2202, 2222, 2246,	 2266, 2282, 2300, 2324, 2344, 2360, 2372, 2390, 2406, 2422, 2438, 2458, 2478, 2494, 2510, 2526, 2546,	  2562, 2582, 2598, 2614, 2630, 2648, 2660, 2670, 2682, 2698, 2710, 2724, 2736, 2752, 2764, \
	2780, 2792,    2808, 2820, 2836, 2848, 2864, 2876, 2888, 2896, 2908, 2920, 2928, 2940, 2948, 2960, 2972, 2984, 2992,	3004, 3014, 3028, 3036, 3048, 3056, 3068, 3080, 3088, 3100, 3110, 3120, 3128, 3140, 3148, 3160, 3168,	 3174, 3182, 3190, 3202, 3210, 3218, 3228, 3240, 3256, 3266, 3276, 3288, 3300, 3306, 3318, 3326, 3334,	  3342, 3350, 3360, 3370, 3378, 3386, 3394, 3398, 3406, 3414, 3422, 3426, 3436, 3444, 3454, 3466, 3476,    3486, 3498, 3502, 3510, 3518, 3526, 3530, 3538, 3546, 3554, 3558, \
	3564, 3570, 3574, 3582, 3590, 3598,	3604, 3610, 3618, 3628, 3634, 3640, 3644, 3652, 3656, 3664, 3670, 3678, 3688, 3696, 3700, 3708, 3712,	 3716, 3722, 3730, 3736, 3740, 3748, 3752, 3756, 3760, 3766, 3774, 3778, 3786, 3790, 3800, 3808, 3812,	  3816, 3824, 3830, 3832, 3842, 3846, 3850, 3854, 3858, 3862, 3864, 3870, 3874, 3878, 3882, 3888, 3894,    3900, 3908, 3912, 3918, 3924, 3928, 3934, 3940, 3946, 3952, 3958, 3966, 3974, 3978, 3982, 3986, 3990,	3994, 4002, 4006, 4010, 4018, 4022, 4032, 4038,\
	4046, 4050, 4056, 4062, 4072, 4076, 4084, 4090, 4095
};

const HI_U16 OV4689_LINE_GAMMA[257]=
{

	0x0,0x50,0xA3,0xF5,0x148,0x199,0x1E8,0x233,0x27A,0x2BD,0x2FC,0x338,0x372,0x3AA,0x3DF,0x414,0x447,0x479,0x4A9,0x4D7,0x504,0x52F,0x559,0x582,0x5A9,0x5CF,0x5F3,0x615,0x636,0x656,0x676,0x695,0x6B4,0x6D3,0x6F1,0x70F,0x72C,0x748,0x764,0x77F,0x79A,0x7B4,0x7CE,0x7E7,0x7FF,0x817,0x82E,0x845,0x85C,0x872,0x887,0x89C,0x8B1,0x8C5,0x8D9,0x8EC,0x900,0x913,0x927,0x93A,0x94D,0x95F,0x971,0x983,0x994,0x9A5,0x9B5,0x9C5,0x9D5,0x9E4,0x9F3,0xA01,0xA10,0xA1E,0xA2C,0xA3A,0xA47,0xA54,0xA61,0xA6E,0xA7B,0xA88,0xA94,0xAA0,0xAAC,0xAB8,\
	0xAC5,0xAD1,0xADD,0xAEA,0xAF6,0xB03,0xB10,0xB1D,0xB29,0xB36,0xB42,0xB4E,0xB5A,0xB66,0xB72,0xB7E,0xB89,0xB95,0xBA0,0xBAB,0xBB7,0xBC2,0xBCD,0xBD9,0xBE4,0xBEF,0xBFA,0xC05,0xC10,0xC1C,0xC27,0xC32,0xC3D,0xC49,0xC54,0xC5F,0xC69,0xC74,0xC7F,0xC89,0xC93,0xC9D,0xCA7,0xCB0,0xCBA,0xCC3,0xCCB,0xCD4,0xCDD,0xCE5,0xCED,0xCF5,0xCFD,0xD05,0xD0D,0xD15,0xD1D,0xD25,0xD2D,0xD35,0xD3D,0xD45,0xD4D,0xD55,0xD5D,0xD65,0xD6D,0xD75,0xD7D,0xD84,0xD8C,0xD94,0xD9B,0xDA3,0xDAA,0xDB1,0xDB8,0xDBF,0xDC6,0xDCD,0xDD4,0xDDA,0xDE1,0xDE8,\
	0xDEE,0xDF5,0xDFB,0xE02,0xE09,0xE0F,0xE16,0xE1D,0xE24,0xE2A,0xE31,0xE38,0xE3F,0xE46,0xE4D,0xE53,0xE5A,0xE61,0xE68,0xE6F,0xE76,0xE7D,0xE84,0xE8B,0xE92,0xE99,0xEA1,0xEA8,0xEAF,0xEB7,0xEBE,0xEC5,0xECC,0xED4,0xEDB,0xEE2,0xEE9,0xEEF,0xEF6,0xEFC,0xF03,0xF09,0xF0F,0xF15,0xF1B,0xF21,0xF27,0xF2D,0xF33,0xF39,0xF3E,0xF44,0xF4A,0xF4F,0xF55,0xF5B,0xF60,0xF66,0xF6B,0xF71,0xF76,0xF7C,0xF81,0xF87,0xF8C,0xF91,0xF97,0xF9C,0xFA1,0xFA7,0xFAC,0xFB1,0xFB7,0xFBC,0xFC1,0xFC6,0xFCB,0xFD1,0xFD6,0xFDB,0xFE0,0xFE5,0xFEA,0xFEF,0xFF5,0xFFA,0xFFF
};

const HI_U16 v200_day_gammaM[257]=
{
0,65,131,198,266,335,404,472,540,607,673,737,799,860,917,972,1023,1071,1117,1160,1201,1240,1277,1313,1347,1380,1411,1442,1472,\
1501,1530,1559,1588,1616,1643,1669,1694,1719,1742,1764,1786,1808,1828,1849,1869,1889,1909,1928,1948,1967,1986,2005,2023,2041,\
2058,2075,2092,2109,2125,2141,2157,2173,2189,2204,2220,2236,2251,2266,2281,2296,2310,2325,2339,2353,2367,2381,2395,2409,2423,\
2437,2451,2465,2479,2493,2507,2520,2534,2548,2561,2575,2588,2602,2615,2628,2641,2653,2666,2678,2691,2703,2715,2726,2738,2749,\
2761,2772,2783,2795,2806,2817,2828,2839,2850,2861,2872,2883,2894,2905,2916,2926,2937,2948,2958,2969,2979,2989,3000,3010,3020,\
3030,3040,3050,3060,3069,3079,3088,3098,3107,3117,3126,3135,3145,3154,3164,3173,3182,3192,3201,3210,3220,3229,3238,3247,3257,\
3266,3275,3284,3294,3303,3313,3322,3332,3341,3351,3361,3371,3381,3391,3401,3411,3421,3431,3440,3450,3460,3469,3478,3487,3496,\
3505,3513,3522,3530,3538,3547,3555,3563,3571,3579,3587,3596,3604,3612,3620,3628,3637,3645,3653,3661,3669,3677,3686,3694,3702,\
3710,3718,3726,3734,3742,3750,3758,3766,3774,3782,3790,3798,3806,3814,3822,3830,3838,3846,3854,3861,3869,3877,3884,3892,3900,\
3907,3915,3922,3930,3937,3945,3952,3959,3967,3974,3981,3988,3995,4002,4009,4016,4022,4029,4036,4042,4049,4055,4062,4069,4075,4082,4088,4095
};
const HI_U16 v200_night_gammaM[257]=
{
0,44,88,133,178,223,268,313,358,402,447,491,536,579,622,663,703,740,776,810,843,876,909,942,976,1012,1048,1084,1120,1156,1192,1226,1260,1292,1323,\
1354,1384,1414,1442,1470,1497,1523,1548,1572,1595,1618,1640,1662,1684,1706,1728,1749,1770,1790,1809,1829,1848,1866,1885,1903,1921,1940,1958,1977,\
1996,2014,2033,2052,2071,2090,2109,2128,2147,2165,2184,2202,2220,2238,2256,2273,2291,2308,2325,2341,2358,2375,2391,2407,2423,2439,2455,2471,2486,\
2501,2516,2531,2546,2560,2574,2588,2601,2614,2628,2641,2653,2666,2679,2691,2704,2716,2728,2741,2754,2766,2779,2791,2804,2816,2828,2841,2853,2865,\
2877,2889,2901,2913,2925,2936,2948,2959,2970,2981,2992,3003,3013,3024,3034,3045,3055,3065,3076,3086,3096,3106,3117,3127,3137,3147,3157,3166,3176,\
3186,3196,3206,3215,3225,3235,3244,3254,3264,3274,3283,3293,3303,3313,3323,3333,3343,3353,3363,3373,3382,3392,3402,3411,3420,3430,3438,3447,3456,\
3464,3473,3481,3489,3498,3506,3514,3522,3530,3538,3547,3555,3564,3572,3581,3589,3598,3606,3615,3624,3632,3641,3650,3658,3667,3676,3684,3693,3702,\
3710,3719,3727,3736,3744,3753,3762,3770,3779,3787,3796,3804,3812,3820,3829,3837,3844,3852,3860,3867,3874,3881,3889,3896,3903,3910,3917,3925,3932,\
3940,3948,3956,3964,3972,3980,3989,3997,4006,4015,4024,4033,4041,4050,4059,4068,4077,4086,4095
};

const HI_U16 v200_night_gammaH[257]=             //夜视高对比度
{0,34,69,103,138,172,207,241,276,310,345,379,413,448,482,517,551,586,620,655,690,726,761,796,831,866,900,935,969,1002,1035,1068,1100,1132,1163,1194,1224,\
1255,1285,1314,1344,1373,1401,1430,1457,1485,1512,1538,1564,1589,1614,1639,1662,1686,1708,1731,1753,1775,1797,1818,1839,1861,1882,1903,1924,1945,1966,\
1987,2008,2029,2049,2069,2090,2110,2129,2149,2168,2187,2206,2225,2243,2261,2279,2296,2313,2330,2347,2364,2380,2396,2412,2428,2444,2459,2475,2491,2506,\
2521,2537,2552,2567,2582,2596,2611,2625,2640,2654,2668,2682,2696,2710,2724,2738,2752,2766,2779,2793,2807,2820,2834,2847,2860,2873,2886,2899,2911,2924,\
2936,2948,2960,2971,2982,2993,3004,3015,3025,3036,3046,3056,3066,3077,3087,3097,3107,3117,3127,3137,3147,3157,3166,3176,3186,3196,3206,3215,3225,3235,\
3244,3254,3264,3274,3283,3293,3303,3313,3323,3333,3343,3353,3363,3373,3382,3392,3402,3411,3420,3430,3438,3447,3456,3464,3473,3481,3489,3498,3506,3514,3522,\
3530,3538,3547,3555,3564,3572,3581,3589,3598,3606,3615,3624,3632,3641,3650,3658,3667,3676,3684,3693,3702,3710,3719,3727,3736,3744,3753,3762,3770,3779,3787,3796,\
3804,3812,3820,3829,3837,3844,3852,3860,3867,3874,3881,3889,3896,3903,3910,3917,3925,3932,3940,3948,3956,3964,3972,3980,3989,3997,4006,4015,4024,4033,4041,4050,4059,4068,4077,4086,4095
};

const HI_U16 v200_day_gammaH[257]=  //基于白天gamma实现的高对比度gamma
{0,52,105,158,212,267,321,375,429,482,535,587,638,688,737,785,831,875,919,961,1003,1044,1084,1123,1161,1199,1236,1272,1308,1342,1377,1410,1444,1476,1508,1538,1568,1598,1626,1654,1682,\
1709,1735,1761,1786,1811,1835,1860,1884,1907,1930,1952,1974,1995,2016,2036,2056,2076,2095,2114,2132,2150,2168,2186,2204,2221,2237,2254,2270,2285,2300,2315,2330,2344,2358,2372,2386,\
2400,2414,2428,2443,2457,2471,2485,2498,2512,2526,2539,2553,2566,2580,2593,2606,2619,2632,2645,2658,2670,2683,2695,2707,2720,2732,2744,2756,2768,2780,2791,2803,2815,2826,2838,2850,\
2861,2873,2884,2896,2907,2918,2930,2941,2952,2963,2974,2985,2996,3007,3017,3028,3038,3048,3058,3068,3077,3087,3096,3106,3115,3125,3134,3143,3152,3162,3171,3181,3190,3199,3209,3218,\
3228,3237,3246,3256,3265,3274,3284,3293,3302,3311,3320,3330,3338,3347,3356,3365,3374,3383,3391,3400,3409,3417,3426,3435,3443,3452,3461,3470,3478,3487,3496,3505,3514,3523,3532,3541,\
3550,3559,3568,3577,3586,3594,3603,3612,3620,3628,3637,3645,3653,3661,3669,3677,3685,3693,3701,3709,3717,3725,3733,3742,3750,3758,3766,3774,3782,3790,3798,3806,3814,3822,3830,3837,\
3845,3853,3861,3869,3877,3884,3892,3900,3907,3915,3922,3930,3937,3945,3952,3959,3967,3974,3981,3988,3995,4002,4009,4016,4022,4029,4036,4042,4049,4055,4062,4069,4075,4082,4088,4095
};


const HI_U16 u16Gamma_2710_night[257] = {0,48,96,144,193,240,287,333,377,419,460,500,540,578,615,652,689,725,761,796,830,864,897,930,962,993,1023,1053,1082,1110,1139,1167,1196,1225,1255,1284,1314,1343,1372,1400,1428,1456,1483,1510,1537,1563,1588,1613,1638,1662,1685,1708,1731,1753,1774,1795,1816,1836,1856,1877,1896,1916,1936,1956,1976,1996,2016,2035,2055,2075,2094,2113,2132,2151,2170,2188,2207,2225,2243,2260,2278,2295,2312,2329,2346,2362,2378,2394,2410,2426,2442,2458,2473,2489,2504,2520,2535,2550,2565,2580,2594,2608,2623,2637,2650,2664,2677,2691,2704,2717,2730,2742,2755,2768,2780,2793,2805,2817,2830,2842,2854,2866,2878,2890,2902,2915,2927,2939,2951,2963,2975,2987,3000,3012,3024,3036,3047,3059,3071,3083,3095,3106,3118,3130,3141,3153,3164,3175,3186,3198,3209,3220,3231,3242,3252,3263,3274,3284,3294,3305,3315,3325,3335,3345,3355,3364,3374,3383,3393,3402,3411,3420,3429,3438,3447,3456,3465,3473,3482,3490,3499,3508,3516,3525,3533,3542,3550,3559,3567,3575,3584,3592,3601,3610,3618,3626,3635,3643,3652,3660,3668,3677,3685,3693,3702,3710,3718,3726,3734,3742,3750,3759,3767,3775,3783,3791,3798,3806,3814,3822,3830,3838,3846,3853,3861,3869,3876,3884,3891,3899,3906,3914,3921,3929,3936,3943,3951,3958,3965,3972,3980,3987,3994,4001,4008,4016,4023,4030,4037,4044,4051,4059,4066,4073,4080,4088,4095};
const HI_U16 u16Gamma_2710_day[257] = {0,53,107,161,215,269,320,370,416,459,500,538,575,611,646,680,715,750,784,818,851,883,915,945,975,1004,1031,1057,1083,1108,1133,1158,1183,1209,1235,1260,1286,1311,1337,1361,1386,1409,1433,1456,1479,1501,1524,1546,1568,1590,1611,1632,1653,1673,1694,1714,1733,1753,1772,1791,1810,1829,1848,1866,1885,1908,1929,1949,1968,1987,2004,2021,2038,2053,2069,2084,2100,2115,2130,2146,2162,2178,2194,2210,2226,2242,2257,2273,2288,2303,2318,2333,2348,2362,2377,2391,2405,2419,2433,2446,2460,2473,2486,2499,2512,2525,2537,2550,2563,2575,2588,2600,2613,2626,2638,2650,2663,2675,2687,2700,2712,2724,2736,2748,2760,2772,2784,2796,2808,2820,2832,2844,2856,2868,2879,2891,2903,2915,2926,2938,2950,2961,2973,2984,2996,3007,3018,3030,3041,3052,3063,3075,3086,3097,3108,3118,3129,3140,3151,3161,3172,3183,3193,3203,3214,3224,3234,3244,3254,3264,3274,3284,3293,3303,3313,3322,3332,3342,3351,3361,3370,3380,3389,3399,3408,3418,3427,3437,3446,3455,3465,3474,3484,3494,3503,3512,3522,3531,3541,3550,3559,3569,3578,3587,3597,3606,3615,3624,3634,3643,3652,3661,3670,3680,3689,3698,3708,3717,3726,3736,3745,3755,3764,3773,3783,3793,3802,3812,3821,3831,3841,3850,3860,3870,3880,3889,3899,3909,3919,3928,3938,3948,3958,3968,3977,3987,3997,4007,4017,4027,4036,4046,4056,4066,4075,4085,4095};
const HI_U16 u16Gamma_gc2003_night[257] = {0,58,117,177,237,296,352,406,455,499,537,571,604,636,671,710,754,779,805,832,861,890,920,951,982,1013,1044,1075,1106,1136,1166,1194,1222,1249,1276,1302,1329,1355,1380,1406,1431,1456,1481,1506,1530,1554,1578,1602,1626,1649,1672,1695,1718,1740,1763,1785,1807,1828,1850,1871,1892,1913,1934,1955,1976,1997,2017,2038,2058,2079,2099,2119,2138,2158,2177,2197,2215,2234,2252,2270,2288,2305,2322,2338,2355,2370,2386,2401,2416,2431,2446,2461,2476,2490,2505,2520,2535,2550,2565,2580,2596,2611,2626,2641,2656,2671,2685,2700,2715,2729,2743,2758,2771,2785,2799,2812,2825,2838,2851,2864,2877,2890,2903,2915,2928,2940,2952,2965,2977,2989,3001,3013,3025,3036,3048,3059,3070,3081,3092,3103,3114,3124,3135,3145,3156,3166,3176,3187,3197,3207,3217,3227,3237,3246,3256,3266,3276,3286,3295,3305,3315,3325,3334,3344,3353,3363,3372,3382,3391,3400,3409,3418,3427,3436,3445,3454,3463,3472,3480,3489,3498,3507,3515,3524,3533,3541,3550,3558,3567,3575,3584,3592,3601,3610,3618,3626,3635,3643,3652,3660,3668,3677,3685,3693,3702,3710,3718,3726,3734,3742,3750,3759,3767,3775,3783,3791,3798,3806,3814,3822,3830,3838,3846,3853,3861,3869,3876,3884,3891,3899,3906,3914,3921,3929,3936,3943,3951,3958,3965,3972,3980,3987,3994,4001,4008,4016,4023,4030,4037,4044,4051,4059,4066,4073,4080,4088,4095};
const HI_U16 u16Gamma_gc2003_day[257] = {0,53,107,161,215,269,320,370,416,459,500,538,575,611,646,680,715,750,784,818,851,883,915,945,975,1004,1031,1057,1083,1108,1133,1158,1183,1209,1235,1260,1286,1311,1337,1361,1386,1409,1433,1456,1479,1501,1524,1546,1568,1590,1611,1632,1653,1673,1694,1714,1733,1753,1772,1791,1810,1829,1848,1866,1885,1908,1929,1949,1968,1987,2004,2021,2038,2053,2069,2084,2100,2115,2130,2146,2162,2178,2194,2210,2226,2242,2257,2273,2288,2303,2318,2333,2348,2362,2377,2391,2405,2419,2433,2446,2460,2473,2486,2499,2512,2525,2537,2550,2563,2575,2588,2600,2613,2626,2638,2650,2663,2675,2687,2700,2712,2724,2736,2748,2760,2772,2784,2796,2808,2820,2832,2844,2856,2868,2879,2891,2903,2915,2926,2938,2950,2961,2973,2984,2996,3007,3018,3030,3041,3052,3063,3075,3086,3097,3108,3118,3129,3140,3151,3161,3172,3183,3193,3203,3214,3224,3234,3244,3254,3264,3274,3284,3293,3303,3313,3322,3332,3342,3351,3361,3370,3380,3389,3399,3408,3418,3427,3437,3446,3455,3465,3474,3484,3494,3503,3512,3522,3531,3541,3550,3559,3569,3578,3587,3597,3606,3615,3624,3634,3643,3652,3661,3670,3680,3689,3698,3708,3717,3726,3736,3745,3755,3764,3773,3783,3793,3802,3812,3821,3831,3841,3850,3860,3870,3880,3889,3899,3909,3919,3928,3938,3948,3958,3968,3977,3987,3997,4007,4017,4027,4036,4046,4056,4066,4075,4085,4095};
const HI_U16 u16Gamma_po1210_night[257] = {0,48,96,144,193,240,287,333,377,419,460,500,540,578,615,652,689,725,761,796,830,864,897,930,962,993,1023,1053,1082,1110,1139,1167,1196,1225,1255,1284,1314,1343,1372,1400,1428,1456,1483,1510,1537,1563,1588,1613,1638,1662,1685,1708,1731,1753,1774,1795,1816,1836,1856,1877,1896,1916,1936,1956,1976,1996,2016,2035,2055,2075,2094,2113,2132,2151,2170,2188,2207,2225,2243,2260,2278,2295,2312,2329,2346,2362,2378,2394,2410,2426,2442,2458,2473,2489,2504,2520,2535,2550,2565,2580,2594,2608,2623,2637,2650,2664,2677,2691,2704,2717,2730,2742,2755,2768,2780,2793,2805,2817,2830,2842,2854,2866,2878,2890,2902,2915,2927,2939,2951,2963,2975,2987,3000,3012,3024,3036,3047,3059,3071,3083,3095,3106,3118,3130,3141,3153,3164,3175,3186,3198,3209,3220,3231,3242,3252,3263,3274,3284,3294,3305,3315,3325,3335,3345,3355,3364,3374,3383,3393,3402,3411,3420,3429,3438,3447,3456,3465,3473,3482,3490,3499,3508,3516,3525,3533,3542,3550,3559,3567,3575,3584,3592,3601,3610,3618,3626,3635,3643,3652,3660,3668,3677,3685,3693,3702,3710,3718,3726,3734,3742,3750,3759,3767,3775,3783,3791,3798,3806,3814,3822,3830,3838,3846,3853,3861,3869,3876,3884,3891,3899,3906,3914,3921,3929,3936,3943,3951,3958,3965,3972,3980,3987,3994,4001,4008,4016,4023,4030,4037,4044,4051,4059,4066,4073,4080,4088,4095};
const HI_U16 u16Gamma_po1210_day[257] = {0,37,72,106,139,173,208,244,282,323,367,416,443,471,500,530,561,592,624,657,691,725,759,794,829,865,901,937,973,1009,1045,1082,1118,1142,1166,1191,1216,1242,1267,1293,1319,1346,1372,1399,1426,1453,1479,1506,1533,1560,1587,1613,1640,1666,1692,1718,1744,1770,1795,1819,1844,1868,1891,1914,1937,1959,1981,2003,2025,2046,2067,2088,2108,2129,2149,2169,2189,2209,2228,2247,2266,2285,2304,2322,2341,2359,2377,2395,2412,2430,2447,2464,2481,2498,2515,2532,2548,2564,2580,2596,2612,2627,2642,2657,2672,2686,2701,2715,2729,2743,2756,2770,2783,2797,2810,2823,2836,2848,2861,2874,2886,2899,2911,2924,2936,2948,2961,2973,2985,2997,3009,3021,3033,3045,3056,3068,3079,3090,3101,3113,3124,3135,3145,3156,3167,3177,3188,3198,3209,3219,3229,3239,3249,3259,3269,3279,3289,3299,3309,3318,3328,3338,3347,3356,3366,3375,3384,3393,3401,3410,3419,3428,3436,3445,3453,3461,3470,3478,3486,3494,3503,3511,3519,3527,3535,3543,3552,3560,3568,3576,3584,3593,3601,3609,3618,3626,3634,3643,3651,3659,3668,3676,3684,3692,3701,3709,3717,3725,3733,3742,3750,3758,3766,3774,3782,3790,3798,3806,3814,3822,3830,3838,3845,3853,3861,3869,3876,3884,3891,3899,3906,3914,3921,3929,3936,3943,3951,3958,3965,3972,3980,3987,3994,4001,4008,4016,4023,4030,4037,4044,4051,4059,4066,4073,4080,4088,4095};
const HI_U16 u16Gamma_bg0803_night[257] = {0,79,157,236,316,400,439,479,520,561,603,645,687,729,772,813,855,884,912,942,971,1000,1030,1059,1088,1117,1146,1174,1202,1230,1257,1283,1309,1334,1359,1383,1407,1430,1453,1476,1498,1520,1542,1563,1584,1605,1626,1647,1667,1688,1707,1727,1746,1765,1784,1803,1821,1839,1857,1875,1893,1911,1928,1946,1963,1980,1997,2014,2031,2048,2064,2081,2097,2113,2129,2145,2161,2176,2192,2208,2223,2238,2254,2269,2284,2299,2314,2328,2343,2357,2372,2386,2401,2415,2429,2443,2457,2471,2485,2499,2512,2526,2539,2553,2566,2579,2593,2606,2619,2632,2644,2657,2670,2682,2694,2706,2718,2730,2742,2754,2766,2778,2790,2801,2813,2825,2837,2848,2860,2872,2883,2895,2906,2918,2929,2940,2951,2962,2973,2984,2995,3006,3017,3027,3038,3049,3059,3070,3081,3091,3102,3112,3123,3134,3144,3155,3165,3176,3187,3197,3208,3219,3230,3240,3251,3262,3273,3284,3295,3305,3316,3327,3338,3349,3360,3370,3381,3392,3403,3413,3424,3434,3445,3455,3466,3476,3486,3496,3506,3517,3526,3536,3546,3556,3565,3575,3584,3593,3603,3612,3621,3630,3639,3648,3657,3665,3674,3683,3691,3700,3709,3717,3726,3734,3743,3751,3760,3768,3777,3785,3794,3802,3811,3819,3828,3837,3845,3854,3862,3871,3879,3887,3896,3904,3913,3921,3929,3938,3946,3954,3962,3971,3979,3987,3996,4004,4012,4020,4029,4037,4045,4053,4062,4070,4078,4087,4095};
const HI_U16 u16Gamma_bg0803_day[257] = {0,61,123,183,238,288,334,378,421,464,506,547,587,624,659,693,729,767,805,843,880,914,947,978,1010,1041,1072,1103,1132,1160,1186,1212,1238,1264,1289,1314,1339,1363,1388,1411,1435,1458,1481,1504,1527,1549,1571,1592,1614,1635,1657,1678,1698,1719,1739,1759,1778,1798,1817,1836,1855,1874,1893,1911,1930,1948,1967,1985,2003,2020,2038,2055,2073,2090,2107,2124,2140,2157,2173,2190,2206,2222,2238,2254,2269,2285,2300,2315,2330,2345,2360,2374,2389,2404,2419,2433,2448,2463,2478,2492,2507,2522,2536,2550,2565,2579,2593,2607,2621,2635,2649,2663,2677,2690,2704,2717,2730,2744,2757,2770,2783,2796,2809,2822,2835,2847,2860,2873,2885,2897,2910,2922,2934,2946,2957,2969,2981,2992,3004,3015,3026,3038,3049,3060,3071,3082,3093,3104,3115,3125,3136,3147,3158,3168,3179,3190,3200,3211,3222,3232,3243,3254,3264,3275,3286,3296,3307,3317,3328,3338,3349,3359,3370,3380,3390,3401,3411,3421,3431,3441,3451,3461,3471,3481,3491,3501,3511,3520,3530,3540,3549,3559,3568,3577,3587,3596,3605,3614,3623,3632,3641,3649,3658,3667,3675,3684,3693,3701,3710,3718,3726,3735,3743,3751,3760,3768,3776,3784,3793,3801,3809,3817,3826,3834,3842,3850,3858,3867,3875,3883,3891,3899,3907,3915,3923,3931,3938,3946,3954,3962,3970,3978,3985,3993,4001,4009,4017,4024,4032,4040,4048,4056,4064,4071,4079,4087,4095};
const HI_U16 u16Gamma_ar0130_night[257] = {0,48,96,144,193,241,287,333,376,417,457,495,532,569,604,640,675,711,745,779,812,844,875,906,936,965,994,1022,1050,1078,1105,1132,1159,1186,1212,1237,1262,1286,1310,1334,1357,1380,1403,1426,1448,1470,1492,1514,1536,1558,1579,1601,1622,1643,1664,1684,1705,1725,1745,1765,1784,1804,1823,1842,1861,1880,1898,1916,1934,1952,1970,1987,2005,2022,2039,2056,2072,2089,2105,2122,2138,2154,2170,2186,2202,2217,2232,2248,2263,2278,2293,2307,2322,2337,2352,2366,2381,2396,2410,2425,2439,2453,2468,2482,2496,2510,2524,2538,2552,2566,2580,2593,2607,2621,2634,2647,2661,2674,2687,2700,2713,2726,2739,2752,2765,2778,2791,2803,2816,2829,2841,2854,2866,2879,2891,2903,2916,2928,2940,2952,2964,2977,2989,3001,3013,3025,3037,3049,3062,3074,3086,3098,3110,3122,3134,3146,3158,3169,3181,3193,3204,3215,3227,3238,3249,3260,3271,3282,3292,3303,3314,3324,3335,3346,3357,3367,3378,3389,3400,3410,3421,3432,3443,3453,3464,3475,3485,3496,3507,3517,3527,3538,3548,3558,3568,3578,3588,3598,3608,3618,3628,3637,3647,3657,3666,3676,3685,3695,3704,3713,3723,3732,3741,3750,3759,3768,3777,3786,3795,3804,3812,3821,3830,3838,3847,3855,3864,3872,3880,3889,3897,3905,3913,3920,3928,3936,3944,3951,3959,3967,3974,3982,3989,3997,4004,4012,4019,4027,4034,4042,4049,4057,4064,4072,4080,4087,4095};
const HI_U16 u16Gamma_ar0130_day[257] = {0,48,96,144,193,241,287,333,376,417,457,495,532,569,604,640,675,711,745,779,812,844,875,906,936,965,994,1022,1050,1078,1105,1132,1159,1186,1212,1237,1262,1286,1310,1334,1357,1380,1403,1426,1448,1470,1492,1514,1536,1558,1579,1601,1622,1643,1664,1684,1705,1725,1745,1765,1784,1804,1823,1842,1861,1880,1898,1916,1934,1952,1970,1987,2005,2022,2039,2056,2072,2089,2105,2122,2138,2154,2170,2186,2202,2217,2232,2248,2263,2278,2293,2307,2322,2337,2352,2366,2381,2396,2410,2425,2439,2453,2468,2482,2496,2510,2524,2538,2552,2566,2580,2593,2607,2621,2634,2647,2661,2674,2687,2700,2713,2726,2739,2752,2765,2778,2791,2803,2816,2829,2841,2854,2866,2879,2891,2903,2916,2928,2940,2952,2964,2977,2989,3001,3013,3025,3037,3049,3062,3074,3086,3098,3110,3122,3134,3146,3158,3169,3181,3193,3204,3215,3227,3238,3249,3260,3271,3282,3292,3303,3314,3324,3335,3346,3357,3367,3378,3389,3400,3410,3421,3432,3443,3453,3464,3475,3485,3496,3507,3517,3527,3538,3548,3558,3568,3578,3588,3598,3608,3618,3628,3637,3647,3657,3666,3676,3685,3695,3704,3713,3723,3732,3741,3750,3759,3768,3777,3786,3795,3804,3812,3821,3830,3838,3847,3855,3864,3872,3880,3889,3897,3905,3913,3920,3928,3936,3944,3951,3959,3967,3974,3982,3989,3997,4004,4012,4019,4027,4034,4042,4049,4057,4064,4072,4080,4087,4095};
const HI_U16 U16Gamma_imx323_day[257]={0,54,106,158,209,259,308,356,403,450,495,540,584,628,670,713,754,795,835,874,913,951,989,1026,1062,1098,1133,1168,1203,1236,1270,1303,1335,1367,1398,1429,1460,1490,1520,1549,1578,1607,1635,1663,1690,1717,1744,1770,1796,1822,1848,1873,1897,1922,1946,1970,1993,2017,2040,2062,2085,2107,2129,2150,2172,2193,2214,2235,2255,2275,2295,2315,2335,2354,2373,2392,2411,2429,2447,2465,2483,2501,2519,2536,2553,2570,2587,2603,2620,2636,2652,2668,2684,2700,2715,2731,2746,2761,2776,2790,2805,2819,2834,2848,2862,2876,2890,2903,2917,2930,2944,2957,2970,2983,2996,3008,3021,3033,3046,3058,3070,3082,3094,3106,3118,3129,3141,3152,3164,3175,3186,3197,3208,3219,3230,3240,3251,3262,3272,3282,3293,3303,3313,3323,3333,3343,3352,3362,3372,3381,3391,3400,3410,3419,3428,3437,3446,3455,3464,3473,3482,3490,3499,3508,3516,3525,3533,3541,3550,3558,3566,3574,3582,3590,3598,3606,3614,3621,3629,3637,3644,3652,3660,3667,3674,3682,3689,3696,3703,3711,3718,3725,3732,3739,3746,3752,3759,3766,3773,3779,3786,3793,3799,3806,3812,3819,3825,3831,3838,3844,3850,3856,3863,3869,3875,3881,3887,3893,3899,3905,3910,3916,3922,3928,3933,3939,3945,3950,3956,3962,3967,3973,3978,3983,3989,3994,3999,4005,4010,4015,4020,4026,4031,4036,4041,4046,4051,4056,4061,4066,4071,4076,4081,4085,4090,4095,4095};
const HI_U16 u16Gamma_ov9732_day[257]={0,54,106,158,209,259,308,356,403,450,495,540,584,628,670,713,754,795,835,874,913,951,989,1026,1062,1098,1133,1168,1203,1236,1270,1303,1335,1367,1398,1429,1460,1490,1520,1549,1578,1607,1635,1663,1690,1717,1744,1770,1796,1822,1848,1873,1897,1922,1946,1970,1993,2017,2040,2062,2085,2107,2129,2150,2172,2193,2214,2235,2255,2275,2295,2315,2335,2354,2373,2392,2411,2429,2447,2465,2483,2501,2519,2536,2553,2570,2587,2603,2620,2636,2652,2668,2684,2700,2715,2731,2746,2761,2776,2790,2805,2819,2834,2848,2862,2876,2890,2903,2917,2930,2944,2957,2970,2983,2996,3008,3021,3033,3046,3058,3070,3082,3094,3106,3118,3129,3141,3152,3164,3175,3186,3197,3208,3219,3230,3240,3251,3262,3272,3282,3293,3303,3313,3323,3333,3343,3352,3362,3372,3381,3391,3400,3410,3419,3428,3437,3446,3455,3464,3473,3482,3490,3499,3508,3516,3525,3533,3541,3550,3558,3566,3574,3582,3590,3598,3606,3614,3621,3629,3637,3644,3652,3660,3667,3674,3682,3689,3696,3703,3711,3718,3725,3732,3739,3746,3752,3759,3766,3773,3779,3786,3793,3799,3806,3812,3819,3825,3831,3838,3844,3850,3856,3863,3869,3875,3881,3887,3893,3899,3905,3910,3916,3922,3928,3933,3939,3945,3950,3956,3962,3967,3973,3978,3983,3989,3994,3999,4005,4010,4015,4020,4026,4031,4036,4041,4046,4051,4056,4061,4066,4071,4076,4081,4085,4090,4095,4095};


#define LINE_DAY_LUM    68
#define LINE_NIGHT_LUM  78
#define LINE_NIGHT_LUM_OV2735  78


#define LINE_HOME_DAY_LUM    72
#define LINE_HOME_NIGHT_LUM  78


#define DEFAULT_MD_LEN 128

HI_U8 gu8SensorMode;
static int sensorid;
int sensorType=0;
//static int user_select_luma=80;
static int user_sensor_mod=0;
static int user_select_gamma=0;

static signed int user_set_contrast=128;
static BOOL nightflag = HI_FALSE;
static signed int user_set_luma=128;

static int sensor_wdr_flag =0; //只用来夜视白天的宽动态切换标志

static float CURRENT_SENSOR_FPS =25.0;
static int   USER_SENSOR_FPS =25;
static int   LowFpsRatio =16;
static pthread_mutex_t isp_rf_mutex = PTHREAD_MUTEX_INITIALIZER;
//extern HI_U32 ov9732_gamma;//


int jv_sensor_wdr_switch(int mode);
int jv_sensor_wdr_mode_get();


BOOL __check_wdr() //判断是否3M wdr 版本
{

	char *devName;
	devName = hwinfo.devName;
	if (devName && (strstr(devName, "3MWDR")))
	{
		return TRUE;
	}
	else
		return FALSE;
}
BOOL __check_live() //判断是否中维直播模式
{

	char *devName;
	devName = hwinfo.devName;
	if (devName && (strstr(devName, "LIVE")))
	{
		return TRUE;
	}
	else
		return FALSE;
}


int isp_wdr_init(int mode)
{
	ISP_DEV IspDev =0;
	
	if(mode==0)//线性
	{
	
	}
	else
	{
	
	}
	return 0;
}




BOOL __check_cp() //判断是否为车牌特定版本。
{

	char *product;
	product = hwinfo.product;
	if (product && (strstr(product, "cp")||strstr(product, "CP")))
	{
		return TRUE;
	}
	else
		return FALSE;
}

static BOOL bOV2735B = FALSE;
BOOL __check_2735B()
{
	return bOV2735B;
}


//向物理寄存器设置data
int set_hwaddr_value(HI_U32 hwaddr,HI_U32 newdata,HI_U32 *old_data)
{
	 VOID* pMem  = NULL;
	 //pMem = memmap(hwaddr, DEFAULT_MD_LEN);
	 if(old_data)
	 *old_data = *(U32*)pMem;                               
	 *(U32*)pMem = newdata;
	 return 0;
}

int reg_spi_read(unsigned int addr)
{
	int fd = -1;
	unsigned int value = 0;
	int ret=0;
	
	// spi硬件使能
	//set_hwaddr_value(0x200f0040,0x1,NULL);
	//set_hwaddr_value(0x200f0044,0x1,NULL);
	//set_hwaddr_value(0x200f0048,0x1,NULL);
	//set_hwaddr_value(0x200f004c,0x1,NULL);

	usleep(100*1000);
	
	fd = open("/dev/spidev0.0", 0);
	if (fd < 0) 
	{		
		printf("Open spidev0.0 error!\n");	
		return -1;
	}
	value = SPI_MODE_3 | SPI_LSB_FIRST;
	ret = ioctl(fd, SPI_IOC_WR_MODE, &value);
	if (ret < 0)    
	{        
		printf("ioctl SPI_IOC_WR_MODE err, value = %d ret = %d\n", value, ret);        
		return ret;    
	}
	value = 8;    
	ret = ioctl(fd, SPI_IOC_WR_BITS_PER_WORD, &value);    
	if (ret < 0)    
	{        
		printf("ioctl SPI_IOC_WR_BITS_PER_WORD err, value = %d ret = %d\n",value, ret);        
		return ret;    
	}    
	value = 2000000;    
	ret = ioctl(fd, SPI_IOC_WR_MAX_SPEED_HZ, &value);    
	if (ret < 0)    
	{        
		printf("ioctl SPI_IOC_WR_MAX_SPEED_HZ err, value = %d ret = %d\n",value, ret);       
		return ret;    
	}

	struct spi_ioc_transfer mesg[1];    
	unsigned char  tx_buf[8] = {0};    
	unsigned char  rx_buf[8] = {0};        
	tx_buf[0] = (addr & 0xff00) >> 8;    
	tx_buf[0] |= 0x80;    
	tx_buf[1] = addr & 0xff;    
	tx_buf[2] = 0;    
	memset(mesg, 0, sizeof(mesg));    
	mesg[0].tx_buf = (__u32)tx_buf;    
	mesg[0].len    = 3;    
	mesg[0].rx_buf = (__u32)rx_buf;    
	mesg[0].cs_change = 1;    
	ret = ioctl(fd, SPI_IOC_MESSAGE(1), mesg);    
	if (ret  < 0)
	{          
		printf("ioctl SPI_IOC_MESSAGE error \n");          
		return -1;      
	}    
	return rx_buf[2];

}


int reg_i2c_write(unsigned int device_addr,unsigned int reg_addr,unsigned int reg_width,unsigned int data_width,unsigned int data)
{
	int fd = -1;
	int ret;
	unsigned int i2c_num, reg_addr_end;
	
	//I2c硬件使能
    //set_hwaddr_value(0x200f0040,0x2,NULL);
	//set_hwaddr_value(0x200f0044,0x2,NULL);
	//set_hwaddr_value(0x200f0048,0x0,NULL);
	//set_hwaddr_value(0x200f004c,0x0,NULL);

	usleep(100*1000);
	
	i2c_num =0;
	
	if (i2c_num == 0)
		fd = open("/dev/i2c-0", O_RDWR);
	else if (i2c_num == 1)
		fd = open("/dev/i2c-1", O_RDWR);
	else if (i2c_num == 2)
		fd = open("/dev/i2c-2", O_RDWR);
	else
		return -1;

	if (fd<0)
	{
		printf("Open i2c dev error!\n");
		return -1;
	}
	
	reg_addr_end = reg_addr;
	ret = ioctl(fd, I2C_SLAVE_FORCE, device_addr);
    if (ret < 0)
    {
        printf("I2C_SLAVE_FORCE error!\n");
        return ret;
    }

    int idx = 0;
    char buf[8];

    buf[idx++] = reg_addr & 0xFF;
    if (reg_width == 2)
    {
    	ret = ioctl(fd, I2C_16BIT_REG, 1);
        buf[idx++] = reg_addr >> 8;
    }
    else
    {
    	ret = ioctl(fd, I2C_16BIT_REG, 0);
    }

    if (ret < 0)
    {
        printf("ioctl I2C_16BIT_REG error!\n");
		close(fd);
        return -1;
    }

    buf[idx++] = data;
    if (data_width == 2)
    {
    	ret = ioctl(fd, I2C_16BIT_DATA, 1);
        buf[idx++] = data >> 8;
    }
    else
    {
    	ret = ioctl(fd, I2C_16BIT_DATA, 0);
    }

    if (ret)
    {
        printf("ioctl I2C_16BIT_DATA error!\n");
		close(fd);
        return -1;
    }

    ret = write(fd, buf, idx);
    if(ret < 0)
    {
    	printf("write error!\n");
		close(fd);
    	return -1;
    }
	close(fd);
	return 0;
}

int reg_i2c_read(unsigned int device_addr,unsigned int reg_addr,unsigned int reg_width,unsigned int data_width)
{
	int fd = -1;
	int ret;
	unsigned int i2c_num, reg_addr_end;
	unsigned int data;
	char recvbuf[4];
	
	//I2c硬件使能
    //set_hwaddr_value(0x200f0040,0x2,NULL);
	//set_hwaddr_value(0x200f0044,0x2,NULL);
	//set_hwaddr_value(0x200f0048,0x0,NULL);
	//set_hwaddr_value(0x200f004c,0x0,NULL);

	usleep(100*1000);

	memset(recvbuf, 0x0, 4);
	
	i2c_num =0;
	
	if (i2c_num == 0)
		fd = open("/dev/i2c-0", O_RDWR);
	else if (i2c_num == 1)
		fd = open("/dev/i2c-1", O_RDWR);
	else if (i2c_num == 2)
		fd = open("/dev/i2c-2", O_RDWR);
	else
		return -1;

	if (fd<0)
	{
		printf("Open i2c dev error!\n");
		return -1;
	}
	
	reg_addr_end = reg_addr;
	ret = ioctl(fd, I2C_SLAVE_FORCE, device_addr);
	
	if (reg_width == 2)
		ret = ioctl(fd, I2C_16BIT_REG, 1);
	else
		ret = ioctl(fd, I2C_16BIT_REG, 0);

	if (data_width == 2)
		ret = ioctl(fd, I2C_16BIT_DATA, 1);
	else
		ret = ioctl(fd, I2C_16BIT_DATA, 0);
	
	if (reg_width == 2) 
	{
		recvbuf[0] = reg_addr & 0xff;
		recvbuf[1] = (reg_addr >> 8) & 0xff;
	} 
	else
		recvbuf[0] = reg_addr & 0xff;

	ret = read(fd, recvbuf, reg_width);
	if (ret < 0)
	{
		printf("read error!\n");
		close(fd);
		return -1;
	}

	if (data_width == 2)
	{
		data = recvbuf[0] | (recvbuf[1] << 8);
	} 
	else
		data = recvbuf[0];

	printf("reg_addr:0x%x data:0x%x\n", reg_addr, data);
	
	close(fd);
	return data;
}

int isp_acm_set_ov2735(BOOL bEnable)
{


	ISP_ACM_LUT_S pstACMLut;
const short LUT_Luma[5][7][29]=
{
    {
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
    },
    {
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
    },
    {
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  -2,   2,   6,  10,  29,  29,  14,  -1,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  -1,   6,  16,  81,  88,  41,   5,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  96, 140,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
    },
    {
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,   9,  13,  22,  48,  51,  24,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   7,  18,  35, 138, 140,  77,   9,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  10,  29, 140, 140,  72,  11,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  -9,  42,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
    },
    {
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
    },
};
const short LUT_Hue[5][7][29]=
{
    {
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
    },
    {
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
    },
    {
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,   2,   2,   2,  10,  10,   4,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,   3,  29,  47,  25,   1,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  63,   9,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
    },
    {
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,   3,   2,   3,  10,  10,   4,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,   3,   5,  28,  38,  15,   1,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,   4,  34,  49,  32,   1,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  27,  -1,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
    },
    {
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
    },
};
const short LUT_Sat[5][7][29]=
{
    {
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
    },
    {
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
    },
    {
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  -2,  -2,  -1,  -1,   1,   5,   3,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  -3,  -6,  -7,  76,  96,   7,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 105,   3,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
    },
    {
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  -2,  -1,  -1,  -1,   2,   7,   3,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   2,   0,   2,  19,  65,  47,   3,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  -6, -14, -20, 121, 128,  16,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  43, -27,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
    },
    {
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
    },
};


	memcpy(&pstACMLut.as16Y,&LUT_Luma,5*7*29 * 2);
	memcpy(&pstACMLut.as16H,&LUT_Hue,5*7*29 * 2);
	memcpy(&pstACMLut.as16S,&LUT_Sat,5*7*29 * 2);
	HI_MPI_ISP_SetAcmCoeff(0,&pstACMLut,ISP_ACM_MODE_GREEN);


	ISP_ACM_ATTR_S pstACMAttr;
	HI_MPI_ISP_GetAcmAttr(0,&pstACMAttr);
	pstACMAttr.bEnable = bEnable;       
	pstACMAttr.bDemoEnable = HI_FALSE;
	pstACMAttr.u32GainLuma = 64;
	pstACMAttr.u32GainHue = 120;
	pstACMAttr.u32GainSat = 64;
	HI_MPI_ISP_SetAcmAttr(0,&pstACMAttr);
	return 0;
	


}
int isp_acm_set_sc2235(BOOL bEnable)
{
	ISP_ACM_LUT_S pstACMLut;
	const short LUT_Luma[5][7][29]=
	{
	    {
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	    },
	    {
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	    },
	    {
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,  -2,  36,  62,  95, 103,  81,  46,  18,   7,  -1,   0,   0,   0,   0,   0,   0,   0,   0,   5,  11,   3,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,  24,  52,  71,  62,  43,  19,   5,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  30,  84,  42,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0, -28, -26, -28,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  30, 115,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	    },
	    {
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   1,  62,  99, 137, 148, 128,  79,  34,  11,  -1,   0,   0,   0,   0,   0,   0,   0,   0,   8,  12,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,  85,   6,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  43, 115,  43,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  31,  69,  57,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  22, -23,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	    },
	    {
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	    },
	};
	const short LUT_Hue[5][7][29]=
	{
	    {
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	    },
	    {
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	    },
	    {
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,  19,  32,  44,  47,  37,  21,   9,   4,   1,   0,   0,   0,   0,   0,   0,   0,   0,   1,   1,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,  10,  19,  25,  22,  16,   7,   2,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   2,  12,   7,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   7,   6,   2,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  20,  -6,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	    },
	    {
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   1,  22,  34,  41,  45,  38,  24,  10,   4,   1,   0,   0,   0,   0,   0,   0,   0,   0,   1,   1,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,  63,  42,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   2,   8,   2,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   2,   6,   6,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   5,   8,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	    },
	    {
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	    },
	};
	const short LUT_Sat[5][7][29]=
	{
	    {
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	    },
	    {
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	    },
	    {
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,  -3,  -6, -14, -28, -37, -34, -23, -11,  -6,  -2,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,  -1,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0, -13, -28, -40, -38, -26, -13,  -6,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  19,  78,  68,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0, -77, -77, -74,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 174,  34,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	    },
	    {
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,  -2,  -3, -11, -24, -35, -36, -26, -15,  -6,  -2,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,  -2,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0, -77, -77,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  17,  57,  25,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  18,  60,  89,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  43,  68,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	    },
	    {
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	        {   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,},
	    },
	};

	memcpy(&pstACMLut.as16Y,&LUT_Luma,5*7*29 * 2);
	memcpy(&pstACMLut.as16H,&LUT_Hue,5*7*29 * 2);
	memcpy(&pstACMLut.as16S,&LUT_Sat,5*7*29 * 2);
	HI_MPI_ISP_SetAcmCoeff(0,&pstACMLut,ISP_ACM_MODE_GREEN);


	ISP_ACM_ATTR_S pstACMAttr;
	HI_MPI_ISP_GetAcmAttr(0,&pstACMAttr);
	pstACMAttr.bEnable = bEnable;       
	pstACMAttr.bDemoEnable = HI_FALSE;
	pstACMAttr.u32GainLuma = 64;
	pstACMAttr.u32GainHue = 160;
	pstACMAttr.u32GainSat = 64;
	HI_MPI_ISP_SetAcmAttr(0,&pstACMAttr);
	return 0;
	
}

/*
特殊类型即设备名称.devName	 不为空的类型放在前面
为空的类型放在后面
*/
Check_Sensor_s Check_Sensor [] = {
	//OV9750m
	{
		.SensorType = SENSOR_OV9750m,
		.Sensor_Name = "ov9750m",
		.devName	= "E2-5013W",
		.Check_Flag = HI_FALSE,
		.CommType 	= I2C,
		.I2c_Attr  	={
				.device_addr = 0x6c,
				.reg_addr 	 = 0x300c,
				.reg_width   = 0x2,
				.data_width  = 0x1,
		},
		.Id_Reg_Value = 0x50
	},
	//OV9750
	{
		.SensorType = SENSOR_OV9750,
		.Sensor_Name = "ov9750",
		.devName	= NULL,
		.Check_Flag = HI_FALSE,
		.CommType 	= I2C,
		.I2c_Attr  	={
				.device_addr = 0x6c,
				.reg_addr 	 = 0x300c,
				.reg_width   = 0x2,
				.data_width  = 0x1,
		},
		.Id_Reg_Value = 0x50
	},
	//OV9732
	{
		.SensorType = SENSOR_OV9732,
		.Sensor_Name = "ov9732",
		.devName	= NULL,
		.Check_Flag = HI_TRUE,
		.CommType 	= I2C,
		.I2c_Attr  	={
				.device_addr = 0x6d,
				.reg_addr 	 = 0x300b,
				.reg_width   = 0x2,
				.data_width  = 0x1,
		},
		.Id_Reg_Value = 0x32
	},
	//OV2710
	{
		.SensorType = SENSOR_OV2710,
		.Sensor_Name = "ov2710",
		.devName	= NULL,
		.Check_Flag = HI_TRUE,
		.CommType 	= I2C,
		.I2c_Attr  	={
				.device_addr = 0x6c,
				.reg_addr 	 = 0x300a,
				.reg_width   = 0x2,
				.data_width  = 0x1,
		},
		.Id_Reg_Value = 0x27
	},
	//OV2735
	{
		.SensorType = SENSOR_OV2735,
		.Sensor_Name = "ov2735",
		.devName	= NULL,
		.Check_Flag = HI_TRUE,
		.CommType 	= I2C,
		.I2c_Attr  	={
				.device_addr = 0x79,
				.reg_addr 	 = 0x02,
				.reg_width   = 0x1,
				.data_width  = 0x1,
		},
		.Id_Reg_Value = 0x27
	},
	//AR0130
	{
		.SensorType = SENSOR_AR0130,
		.Sensor_Name = "ar0130",
		.devName	= NULL,
		.Check_Flag = HI_TRUE,
		.CommType 	= I2C,
		.I2c_Attr  	={
				.device_addr = 0x20,
				.reg_addr 	 = 0x3000,
				.reg_width   = 0x2,
				.data_width  = 0x2,
		},
		.Id_Reg_Value = 0x2402
	},
	//SC2045
	{
		.SensorType = SENSOR_SC2045,
		.Sensor_Name = "sc2045",
		.devName	= NULL,
		.Check_Flag = HI_TRUE,
		.CommType 	= I2C,
		.I2c_Attr  	={
				.device_addr = 0x60,
				.reg_addr 	 = 0x3107,
				.reg_width   = 0x2,
				.data_width  = 0x2,
		},
		.Id_Reg_Value = 0x2045
	},
	//SC2135
	{
		.SensorType = SENSOR_SC2135,
		.Sensor_Name = "sc2135",
		.devName	= NULL,
		.Check_Flag = HI_TRUE,
		.CommType 	= I2C,
		.I2c_Attr  	={
				.device_addr = 0x60,
				.reg_addr 	 = 0x3107,
				.reg_width   = 0x2,
				.data_width  = 0x2,
		},
		.Id_Reg_Value = 0x2135
	},
	//MN34227
	{
		.SensorType = SENSOR_MN34227,
		.Sensor_Name = "mn34227",
		.devName	= NULL,
		.Check_Flag = HI_TRUE,
		.CommType 	= I2C,
		.I2c_Attr  	={
				.device_addr = 0x6c,
				.reg_addr 	 = 0x01,
				.reg_width   = 0x2,
				.data_width  = 0x1,
		},
		.Id_Reg_Value = 0x2
	},
	//SC2235
	{
		.SensorType = SENSOR_SC2235,
		.Sensor_Name = "sc2235",
		.devName	= NULL,
		.Check_Flag = HI_TRUE,
		.CommType 	= I2C,
		.I2c_Attr  	={
				.device_addr = 0x60,
				.reg_addr 	 = 0x3107,
				.reg_width   = 0x2,
				.data_width  = 0x2,
		},
		.Id_Reg_Value = 0x2235
	}
	
};
//处理sensor检测标志
void Set_Check_Sensor_CheckFlag(char *sensor_name)
{
	int i = 0;
	int sensor_num = sizeof(Check_Sensor)/sizeof(Check_Sensor [0]);
	for(i=0;i<sensor_num;i++)
	{
		if(!strcmp(Check_Sensor[i].Sensor_Name,sensor_name))
		{
			Check_Sensor[i].Check_Flag = HI_TRUE;
			break;
		}
	}
	return;
}
//预处理同一个sensor不同的状况
void Pre_Check_Sensor()
{
	if((!strcmp(hwinfo.devName, "E2-5013W")))
		Set_Check_Sensor_CheckFlag("ov9750m");
	else
		Set_Check_Sensor_CheckFlag("ov9750");
}
int isp_ioctl(int fd,int cmd,unsigned long value)
{
	ISP_DEV IspDev = 0;

	switch (cmd)
	{
#if 1
		case ADJ_SCENE://场景选择
			{

				if(value == IN_DOOR)
				{

				}
				else if(value == OUT_DOOR)
				{

				}
				else if(value == NIGHT_MODE)
				{
					ISP_SATURATION_ATTR_S pstSatAttr;         //设置黑白
					pstSatAttr.enOpType = OP_TYPE_MANUAL;
					pstSatAttr.stManual.u8Saturation = 0;
					HI_MPI_ISP_SetSaturationAttr(IspDev, &pstSatAttr);      
				}
				else if(value == DAY_MODE)
				{ 
					ISP_SATURATION_ATTR_S pstSatAttr;
					pstSatAttr.enOpType = OP_TYPE_MANUAL;
					pstSatAttr.stManual.u8Saturation = 0x80;
					HI_MPI_ISP_SetSaturationAttr(IspDev, &pstSatAttr);//恢复彩色模式

				}
				else if(CHECK_NIGHT== value)
				{
					//entering night mode
					nightflag = HI_TRUE;
					isp_ioctl(0,ADJ_BRIGHTNESS,user_set_luma);
					if(sensorid == SENSOR_OV9750||sensorid == SENSOR_OV9750m)
					{
						//isp_ioctl(0,ADJ_BRIGHTNESS,user_set_luma);
						ISP_GAMMA_ATTR_S pstGammaAttr;
						pstGammaAttr.bEnable = HI_TRUE;
						pstGammaAttr.enCurveType = ISP_GAMMA_CURVE_USER_DEFINE;
						memcpy(&pstGammaAttr.u16Table,&v200_night_gammaM,257 * 2);
						HI_MPI_ISP_SetGammaAttr(IspDev,&pstGammaAttr);
					}
					if(sensorid == SENSOR_MN34227)
					{
						//isp_ioctl(0,ADJ_BRIGHTNESS,user_set_luma);
						ISP_GAMMA_ATTR_S pstGammaAttr;
						pstGammaAttr.bEnable = HI_TRUE;
						pstGammaAttr.enCurveType = ISP_GAMMA_CURVE_USER_DEFINE;
						memcpy(&pstGammaAttr.u16Table,&v200_night_gammaM,257 * 2);
						HI_MPI_ISP_SetGammaAttr(IspDev,&pstGammaAttr);

						ISP_EXPOSURE_ATTR_S stExpAttr;
						HI_MPI_ISP_GetExposureAttr(IspDev, &stExpAttr);
						stExpAttr.stAuto.stSysGainRange.u32Max = 256*1024; 
						stExpAttr.u8AERunInterval=1;
						HI_MPI_ISP_SetExposureAttr(IspDev, &stExpAttr);
					}
					if(sensorid == SENSOR_OV2710)
					{	
#if 0
						ISP_GAMMA_ATTR_S pstGammaAttr;
						pstGammaAttr.bEnable = HI_TRUE;
						pstGammaAttr.enCurveType = ISP_GAMMA_CURVE_USER_DEFINE;
						memcpy(&pstGammaAttr.u16Table,&u16Gamma_2710_night,257 * 2);
						HI_MPI_ISP_SetGammaAttr(IspDev,&pstGammaAttr);

						ISP_SHADING_ATTR_S pstShadingAttr;
						HI_MPI_ISP_GetMeshShadingAttr(IspDev,&pstShadingAttr);
						pstShadingAttr.bEnable = HI_TRUE;
						pstShadingAttr.enOpType = 0;
						HI_MPI_ISP_SetMeshShadingAttr(IspDev,&pstShadingAttr);

						ISP_SHARPEN_ATTR_S pstSharpenAttr;
						HI_U8 au8SharD[16]={125,116,110,100,100,100,96,65,18,200,250,250,250,250,250,250}; 
						HI_U8 au8SharUd[16]={128,122,116,116,108,108,102,80,80,250,250,250,250,250,250,250};
						HI_U8 au8Over[16]={78,78,74,74,70,70,70,68,68,68,0,0,0,0,0,0};
						HI_U8 au8Under[16]={100,100,96,96,90,90,86,75,75,0,0,0,0,0,0,0};
						HI_MPI_ISP_GetSharpenAttr(0,&pstSharpenAttr);
						pstSharpenAttr.bEnable = HI_TRUE;
						pstSharpenAttr.enOpType = OP_TYPE_AUTO;
						memcpy(&pstSharpenAttr.stAuto.au8SharpenD,&au8SharD,16);
						memcpy(&pstSharpenAttr.stAuto.au8SharpenUd,&au8SharUd,16);
						memcpy(&pstSharpenAttr.stAuto.au8OverShoot,&au8Over,16);
						memcpy(&pstSharpenAttr.stAuto.au8UnderShoot,&au8Under,16);
						HI_MPI_ISP_SetSharpenAttr(0,&pstSharpenAttr);
#else
						ISP_GAMMA_ATTR_S pstGammaAttr;
						pstGammaAttr.bEnable = HI_TRUE;
						pstGammaAttr.enCurveType = ISP_GAMMA_CURVE_USER_DEFINE;
						memcpy(&pstGammaAttr.u16Table,&v200_night_gammaM,257 * 2);
						HI_MPI_ISP_SetGammaAttr(IspDev,&pstGammaAttr);
#endif
					}
					if(sensorid == SENSOR_SC2135)
					{	
						ISP_GAMMA_ATTR_S pstGammaAttr;
						pstGammaAttr.bEnable = HI_TRUE;
						pstGammaAttr.enCurveType = ISP_GAMMA_CURVE_USER_DEFINE;
						memcpy(&pstGammaAttr.u16Table,&v200_night_gammaM,257 * 2);
						HI_MPI_ISP_SetGammaAttr(IspDev,&pstGammaAttr);
					}
					if(sensorid == SENSOR_AR0130)
					{		
						ISP_GAMMA_ATTR_S pstGammaAttr;
						pstGammaAttr.bEnable = HI_TRUE;
						pstGammaAttr.enCurveType = ISP_GAMMA_CURVE_USER_DEFINE;
						memcpy(&pstGammaAttr.u16Table,&u16Gamma_ar0130_night,257 * 2);
						HI_MPI_ISP_SetGammaAttr(IspDev,&pstGammaAttr);

						ISP_SHADING_ATTR_S pstShadingAttr;
						HI_MPI_ISP_GetMeshShadingAttr(IspDev,&pstShadingAttr);
						pstShadingAttr.bEnable = HI_TRUE;
						pstShadingAttr.enOpType = 0;
						HI_MPI_ISP_SetMeshShadingAttr(IspDev,&pstShadingAttr);

						ISP_SHARPEN_ATTR_S pstSharpenAttr;
						HI_U8 au8SharD[16]={130,120,112,103,100,100,96,80,70,200,250,250,250,250,250,250}; 
						HI_U8 au8SharUd[16]={128,122,116,116,108,108,102,80,80,250,250,250,250,250,250,250};
						HI_U8 au8Over[16]={78,78,74,74,70,70,70,70,70,70,70,70,70,68,68,68};
						HI_U8 au8Under[16]={100,100,96,96,90,90,80,80,80,80,80,80,75,75,75,75};
						HI_MPI_ISP_GetSharpenAttr(0,&pstSharpenAttr);
						pstSharpenAttr.bEnable = HI_TRUE;
						pstSharpenAttr.enOpType = OP_TYPE_AUTO;
						memcpy(&pstSharpenAttr.stAuto.au8SharpenD,&au8SharD,16);
						memcpy(&pstSharpenAttr.stAuto.au8SharpenUd,&au8SharUd,16);
						memcpy(&pstSharpenAttr.stAuto.au8OverShoot,&au8Over,16);
						memcpy(&pstSharpenAttr.stAuto.au8UnderShoot,&au8Under,16);
						HI_MPI_ISP_SetSharpenAttr(0,&pstSharpenAttr);
					}

					if(sensorid == SENSOR_SC2045)
					{
						//isp_ioctl(0,ADJ_BRIGHTNESS,user_set_luma);
						ISP_GAMMA_ATTR_S pstGammaAttr;
						pstGammaAttr.bEnable = HI_TRUE;
						pstGammaAttr.enCurveType = ISP_GAMMA_CURVE_USER_DEFINE;
						memcpy(&pstGammaAttr.u16Table,&V200_LINE_NIGHT_LV0_GAMMA,257 * 2);
						HI_MPI_ISP_SetGammaAttr(IspDev,&pstGammaAttr);
						ISP_SHARPEN_ATTR_S pstSharpenAttr;
						HI_U8 au8SharD[16]={100, 95, 90, 85,  80,  75,  70,  60,    50,  250,  250,   250,   250,   250,    250,    250};
						HI_U8 au8SharUd[16]={85,  80,  80,  75,  70,  60,  50,  15,    15,  200,  250,   250,   250,   250,    250,    250};
						HI_U8 au8Over[16]={50,  50,  50,  50,  50,  50,  50,   50,  50,  0,   0,    0,   0,    0,    0,      0};
						HI_U8 au8Under[16]={80, 80, 80, 80, 90, 90,  90,  80, 60,  0,   0,    0,   0,    0,    0,     0};
						HI_MPI_ISP_GetSharpenAttr(0,&pstSharpenAttr);
						pstSharpenAttr.bEnable = HI_TRUE;
						pstSharpenAttr.enOpType = OP_TYPE_AUTO;
						memcpy(&pstSharpenAttr.stAuto.au8SharpenD,&au8SharD,16);
						memcpy(&pstSharpenAttr.stAuto.au8SharpenUd,&au8SharUd,16);
						memcpy(&pstSharpenAttr.stAuto.au8OverShoot,&au8Over,16);
						memcpy(&pstSharpenAttr.stAuto.au8UnderShoot,&au8Under,16);
						HI_MPI_ISP_SetSharpenAttr(0,&pstSharpenAttr);
						HI_U8 u8Strength_n[16] = {150,150,150,150,130,130,140,130,130,100,100,100,100,100,100,100};
						HI_U8 u8fix_Strength_n[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
						HI_U16 u16Threshold_n[16] = {1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1200,1200,1200,1200,1200,1200};
						ISP_NR_ATTR_S pstNRAttr;
						HI_MPI_ISP_GetNRAttr(0,&pstNRAttr);
						memcpy(&pstNRAttr.stAuto.au8VarStrength,u8Strength_n,16);
						memcpy(&pstNRAttr.stAuto.au8FixStrength,u8fix_Strength_n,16);
						memcpy(&pstNRAttr.stAuto.au16Threshold,u16Threshold_n,16*2);
						HI_MPI_ISP_SetNRAttr(0,&pstNRAttr);

					}
					else if(sensorid == SENSOR_OV9732)
					{
						//isp_ioctl(0,ADJ_BRIGHTNESS,user_set_luma);
						/*					
											ISP_GAMMA_ATTR_S pstGammaAttr;
											pstGammaAttr.bEnable = HI_TRUE;
											pstGammaAttr.enCurveType = ISP_GAMMA_CURVE_USER_DEFINE;
											memcpy(&pstGammaAttr.u16Table,&V200_LINE_DAY_LV1_GAMMA,257 * 2);*/
						//ov9732_gamma = 4;

						ISP_GAMMA_ATTR_S pstGammaAttr;
						pstGammaAttr.bEnable = HI_TRUE;
						pstGammaAttr.enCurveType = ISP_GAMMA_CURVE_USER_DEFINE;
						memcpy(&pstGammaAttr.u16Table,&v200_night_gammaM,257 * 2);
						HI_MPI_ISP_SetGammaAttr(IspDev,&pstGammaAttr);

						ISP_SHARPEN_ATTR_S pstSharpenAttr;
						HI_U8 au8SharD[16]={100,95,90,90,90,90,90,90,18,200,250,250,250,250,250,250}; 
						HI_U8 au8SharUd[16]={90,85,80,70,55,50,40,40,50,250,250,250,250,250,250,250};
						HI_U8 au8Over[16]={50,50,50,50,50,50,50,50,68,0,0,0,0,0,0,0};
						HI_U8 au8Under[16]={80,80,80,80,80,80,80,80,80,0,0,0,0,0,0,0};
						HI_BOOL au8EnLowLumaShoot[16]={0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1};
						HI_U8 au8TextureNoiseThd[16]={0,0,0,0,0,12,20,30,36,0,0,0,0,0,0,0};
						HI_U8 au8EdgeNoiseThd[16]={0,0,0,0,0,8,12,16,20,0,0,0,0,0,0,0};

						HI_MPI_ISP_GetSharpenAttr(0,&pstSharpenAttr);
						pstSharpenAttr.bEnable = HI_TRUE;
						pstSharpenAttr.enOpType = OP_TYPE_AUTO;
						memcpy(&pstSharpenAttr.stAuto.au8SharpenD,&au8SharD,16);
						memcpy(&pstSharpenAttr.stAuto.au8SharpenUd,&au8SharUd,16);
						memcpy(&pstSharpenAttr.stAuto.au8OverShoot,&au8Over,16);
						memcpy(&pstSharpenAttr.stAuto.au8UnderShoot,&au8Under,16);
						memcpy(&pstSharpenAttr.stAuto.abEnLowLumaShoot,&au8EnLowLumaShoot,16*sizeof(HI_BOOL));
						memcpy(&pstSharpenAttr.stAuto.au8TextureNoiseThd,&au8TextureNoiseThd,16);
						memcpy(&pstSharpenAttr.stAuto.au8EdgeNoiseThd,&au8EdgeNoiseThd,16);
						HI_MPI_ISP_SetSharpenAttr(0,&pstSharpenAttr);
					}
					if(sensorid == SENSOR_OV2735)
					{
						ISP_GAMMA_ATTR_S pstGammaAttr;
						pstGammaAttr.bEnable = HI_TRUE;
						pstGammaAttr.enCurveType = ISP_GAMMA_CURVE_USER_DEFINE;
						memcpy(&pstGammaAttr.u16Table,&v200_night_gammaM,257 * 2);
						HI_MPI_ISP_SetGammaAttr(IspDev,&pstGammaAttr);

						isp_acm_set_ov2735(FALSE);
						ISP_SHARPEN_ATTR_S pstSharpenAttr;
						HI_U8 au8SharD[16]={110, 112, 110, 122,  125,  115,  105,  95,    95,  60,  50,   50,   50,   50,    50,    50}; 
						HI_U8 au8SharUd[16]={92,  82,  65,  60,  50,  45,  35,  30,    25,  15,  15,   15,   15,   15,    15,    15};
						HI_U8 au8Over[16]={43,  58,	58,  58,  58,  58,	55,   45,  40,	40,   50,	 50,   50,	  50,	 50,	  50};/*overshootAmt*/
						HI_U8 au8Under[16]={90, 105, 105, 122, 125, 130, 125,  120, 80,  0,	0,	  0,   0,	 0,    0,	  0};/*undershootAmt*/

						HI_MPI_ISP_GetSharpenAttr(0,&pstSharpenAttr);
						pstSharpenAttr.bEnable = HI_TRUE;
						pstSharpenAttr.enOpType = OP_TYPE_AUTO;
						memcpy(&pstSharpenAttr.stAuto.au8SharpenD,&au8SharD,16);
						memcpy(&pstSharpenAttr.stAuto.au8SharpenUd,&au8SharUd,16);
						memcpy(&pstSharpenAttr.stAuto.au8OverShoot,&au8Over,16);
						memcpy(&pstSharpenAttr.stAuto.au8UnderShoot,&au8Under,16);

						HI_MPI_ISP_SetSharpenAttr(0,&pstSharpenAttr);

						ISP_EXPOSURE_ATTR_S stExpAttr;
						HI_MPI_ISP_GetExposureAttr(IspDev, &stExpAttr);
						stExpAttr.stAuto.stSysGainRange.u32Max = 55*1024;
						stExpAttr.u8AERunInterval =1;
						HI_MPI_ISP_SetExposureAttr(IspDev, &stExpAttr);
						if(HWTYPE_MATCH(HW_TYPE_V3))
						{			
							HI_U16 dpc_slope[16] = {80,80,100,250,250,250,250,250,250,252,252,252,252,252,252,252};
							ISP_DP_DYNAMIC_ATTR_S  pstDPDynamicAttr;
							HI_MPI_ISP_GetDPDynamicAttr(0, &pstDPDynamicAttr);
							pstDPDynamicAttr.bEnable=HI_TRUE;
							pstDPDynamicAttr.enOpType=OP_TYPE_AUTO;
							memcpy(pstDPDynamicAttr.stAuto.au16Slope,dpc_slope,16*2);
							HI_MPI_ISP_SetDPDynamicAttr(0,&pstDPDynamicAttr);
						}
					}
					if(sensorid == SENSOR_SC2235)
					{
						isp_ioctl(0,ADJ_CONTRAST,user_set_contrast);
						ISP_SHARPEN_ATTR_S pstSharpenAttr;
						HI_U8 au8SharD[16]={130,130,130,130,130,120,115,105,100,100,100,100,100,100,100,100}; 
						HI_U8 au8SharUd[16]={118,115,113,110,110,80,68,55,50,50,50,50,50,50,50,50};
						HI_U8 au8Over[16]={68,72,80,80,80,70,63,55,50,50,50,50,50,50,50,50};
						HI_U8 au8Under[16]={122,122,120,120,125,120,112,105,100,100,100,100,100,100,100,100};
						HI_BOOL au8EnLowLumaShoot[16]={0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1};
						HI_U8 au8TextureNoiseThd[16]={8,8,8,12,22,25,28,30,25,25,25,25,25,25,25,25};
						HI_U8 au8EdgeNoiseThd[16]={0,1,2,3,5,7,8,10,10,10,10,10,10,10,10,10};

						HI_MPI_ISP_GetSharpenAttr(0,&pstSharpenAttr);
						pstSharpenAttr.bEnable = HI_TRUE;
						pstSharpenAttr.enOpType = OP_TYPE_AUTO;
						memcpy(&pstSharpenAttr.stAuto.au8SharpenD,&au8SharD,16);
						memcpy(&pstSharpenAttr.stAuto.au8SharpenUd,&au8SharUd,16);
						memcpy(&pstSharpenAttr.stAuto.au8OverShoot,&au8Over,16);
						memcpy(&pstSharpenAttr.stAuto.au8UnderShoot,&au8Under,16);
						memcpy(&pstSharpenAttr.stAuto.abEnLowLumaShoot,&au8EnLowLumaShoot,16*sizeof(HI_BOOL));
						memcpy(&pstSharpenAttr.stAuto.au8TextureNoiseThd,&au8TextureNoiseThd,16);
						memcpy(&pstSharpenAttr.stAuto.au8EdgeNoiseThd,&au8EdgeNoiseThd,16);
						HI_MPI_ISP_SetSharpenAttr(0,&pstSharpenAttr);

						isp_acm_set_sc2235(FALSE);

						ISP_EXPOSURE_ATTR_S stExpAttr;
						HI_MPI_ISP_GetExposureAttr(IspDev, &stExpAttr);
						stExpAttr.stAuto.stSysGainRange.u32Max = 96*1024;//118*1024;
						stExpAttr.u8AERunInterval =1;
						HI_MPI_ISP_SetExposureAttr(IspDev, &stExpAttr);

						/*ISP_COLOR_TONE_ATTR_S  pstCTAttr;
						  HI_MPI_ISP_GetColorToneAttr(0, &pstCTAttr);
						  pstCTAttr.u16RedCastGain = 256;
						  pstCTAttr.u16GreenCastGain = 256;
						  pstCTAttr.u16BlueCastGain = 256;
						  HI_MPI_ISP_SetColorToneAttr(0, &pstCTAttr);*/
					}

				}
				else if(CHECK_DAY == value)
				{
					//entering day mode
					nightflag = HI_FALSE;				
					isp_ioctl(0,ADJ_BRIGHTNESS,user_set_luma);
					isp_ioctl(0,ADJ_CONTRAST,user_set_contrast);
					if(sensorid == SENSOR_OV9750||sensorid == SENSOR_OV9750m)
					{

					}
					if(sensorid == SENSOR_MN34227)
					{
						ISP_EXPOSURE_ATTR_S stExpAttr;
						HI_MPI_ISP_GetExposureAttr(IspDev, &stExpAttr);
						stExpAttr.stAuto.stSysGainRange.u32Max = 256*1024; 
						stExpAttr.u8AERunInterval=1;
						HI_MPI_ISP_SetExposureAttr(IspDev, &stExpAttr);
					}
					if(sensorid == SENSOR_OV2710)
					{	
#if 0	
						ISP_GAMMA_ATTR_S pstGammaAttr;
						pstGammaAttr.bEnable = HI_TRUE;
						pstGammaAttr.enCurveType = ISP_GAMMA_CURVE_USER_DEFINE;
						memcpy(&pstGammaAttr.u16Table,&u16Gamma_2710_day,257 * 2);
						HI_MPI_ISP_SetGammaAttr(IspDev,&pstGammaAttr);

						ISP_SHADING_ATTR_S pstShadingAttr;
						HI_MPI_ISP_GetMeshShadingAttr(IspDev,&pstShadingAttr);
						pstShadingAttr.bEnable = HI_FALSE;
						pstShadingAttr.enOpType = 0;
						HI_MPI_ISP_SetMeshShadingAttr(IspDev,&pstShadingAttr);

						ISP_SHARPEN_ATTR_S pstSharpenAttr;
						HI_U8 au8SharD[16]={125,116,108,100,92,84,84,84,84,200,250,250,250,250,250,250}; 
						HI_U8 au8SharUd[16]={120,116,110,100,95,90,90,90,90,250,250,250,250,250,250,250};
						HI_U8 au8Over[16]={55,55,55,55,55,70,70,70,70,0,0,0,0,0,0,0};
						HI_U8 au8Under[16]={85,85,85,85,85,85,85,85,85,0,0,0,0,0,0,0};
						HI_MPI_ISP_GetSharpenAttr(0,&pstSharpenAttr);
						pstSharpenAttr.bEnable = HI_TRUE;
						pstSharpenAttr.enOpType = OP_TYPE_AUTO;
						memcpy(&pstSharpenAttr.stAuto.au8SharpenD,&au8SharD,16);
						memcpy(&pstSharpenAttr.stAuto.au8SharpenUd,&au8SharUd,16);
						memcpy(&pstSharpenAttr.stAuto.au8OverShoot,&au8Over,16);
						memcpy(&pstSharpenAttr.stAuto.au8UnderShoot,&au8Under,16);
						HI_MPI_ISP_SetSharpenAttr(0,&pstSharpenAttr);
#else 
#endif
					}
					if(sensorid == SENSOR_AR0130)
					{		
						ISP_GAMMA_ATTR_S pstGammaAttr;
						pstGammaAttr.bEnable = HI_TRUE;
						pstGammaAttr.enCurveType = ISP_GAMMA_CURVE_USER_DEFINE;
						memcpy(&pstGammaAttr.u16Table,&u16Gamma_ar0130_day,257 * 2);
						HI_MPI_ISP_SetGammaAttr(IspDev,&pstGammaAttr);

						ISP_SHADING_ATTR_S pstShadingAttr;
						HI_MPI_ISP_GetMeshShadingAttr(IspDev,&pstShadingAttr);
						pstShadingAttr.bEnable = HI_FALSE;
						pstShadingAttr.enOpType = 0;
						HI_MPI_ISP_SetMeshShadingAttr(IspDev,&pstShadingAttr);

						ISP_SHARPEN_ATTR_S pstSharpenAttr;
						HI_U8 au8SharD[16]={118,112,110,104,98,92,84,84,84,200,250,250,250,250,250,250}; 
						HI_U8 au8SharUd[16]={128,122,116,110,102,96,90,90,90,250,250,250,250,250,250,250};
						HI_U8 au8Over[16]={50,50,50,50,50,50,50,70,70,60,0,0,0,0,0,0};
						HI_U8 au8Under[16]={92,88,88,85,85,85,85,85,85,0,0,0,0,0,0,0};
						HI_MPI_ISP_GetSharpenAttr(0,&pstSharpenAttr);
						pstSharpenAttr.bEnable = HI_TRUE;
						pstSharpenAttr.enOpType = OP_TYPE_AUTO;
						memcpy(&pstSharpenAttr.stAuto.au8SharpenD,&au8SharD,16);
						memcpy(&pstSharpenAttr.stAuto.au8SharpenUd,&au8SharUd,16);
						memcpy(&pstSharpenAttr.stAuto.au8OverShoot,&au8Over,16);
						memcpy(&pstSharpenAttr.stAuto.au8UnderShoot,&au8Under,16);
						HI_MPI_ISP_SetSharpenAttr(0,&pstSharpenAttr);
					}
					if(sensorid == SENSOR_SC2045)
					{
						ISP_GAMMA_ATTR_S pstGammaAttr;
						pstGammaAttr.bEnable = HI_TRUE;
						pstGammaAttr.enCurveType = ISP_GAMMA_CURVE_USER_DEFINE;
						memcpy(&pstGammaAttr.u16Table,&V200_LINE_DAY_LV0_GAMMA,257 * 2);
						HI_MPI_ISP_SetGammaAttr(IspDev,&pstGammaAttr);

						ISP_SHADING_ATTR_S pstShadingAttr;
						HI_MPI_ISP_GetMeshShadingAttr(IspDev,&pstShadingAttr);
						pstShadingAttr.bEnable = HI_FALSE;
						pstShadingAttr.enOpType = 0;
						HI_MPI_ISP_SetMeshShadingAttr(IspDev,&pstShadingAttr);

						ISP_SHARPEN_ATTR_S pstSharpenAttr;
						HI_U8 au8SharD[16]={130, 120, 105, 95,  80,  75,  75,  70,    50,  250,  250,   250,   250,   250,    250,    250};
						HI_U8 au8SharUd[16]={75,  70,  70,  70,  45,  30,  50,  15,    15,  200,  250,   250,   250,   250,    250,    250};
						HI_U8 au8Over[16]={50,  50,  50,  50,  50,  50,  50,   50,  50,  0,   0,    0,   0,    0,    0,      0};
						HI_U8 au8Under[16]={80, 80, 80, 80, 90, 90,  90,  80, 60,  0,   0,    0,   0,    0,    0,     0};

						HI_MPI_ISP_GetSharpenAttr(0,&pstSharpenAttr);
						pstSharpenAttr.bEnable = HI_TRUE;
						pstSharpenAttr.enOpType = OP_TYPE_AUTO;
						memcpy(&pstSharpenAttr.stAuto.au8SharpenD,&au8SharD,16);
						memcpy(&pstSharpenAttr.stAuto.au8SharpenUd,&au8SharUd,16);
						memcpy(&pstSharpenAttr.stAuto.au8OverShoot,&au8Over,16);
						memcpy(&pstSharpenAttr.stAuto.au8UnderShoot,&au8Under,16);
						HI_MPI_ISP_SetSharpenAttr(0,&pstSharpenAttr);

						HI_U8 u8Strength[16] = {120,130,140,150,160,170,170,130,130,100,100,100,100,100,100,100};
						HI_U8 u8fix_Strength[16] = {0,0,0,40,40,40,40,40,130,100,100,100,100,100,100,100};
						HI_U16 u16Threshold[16] = {1500,1500,1500,1500,1500,1600,1750,1500,1500,1500,1200,1200,1200,1200,1200,1200};
						ISP_NR_ATTR_S pstNRAttr;
						HI_MPI_ISP_GetNRAttr(0,&pstNRAttr);
						memcpy(&pstNRAttr.stAuto.au8VarStrength,u8Strength,16);
						memcpy(&pstNRAttr.stAuto.au8FixStrength,u8fix_Strength,16);
						memcpy(&pstNRAttr.stAuto.au16Threshold,u16Threshold,16*2);
						HI_MPI_ISP_SetNRAttr(0,&pstNRAttr);
					}
					else if(sensorid == SENSOR_OV9732)
					{
						ISP_SHARPEN_ATTR_S pstSharpenAttr;
						HI_U8 au8SharD[16]={90,90,80,80,80,80,80,80,18,200,250,250,250,250,250,250}; 
						HI_U8 au8SharUd[16]={80,75,70,65,60,55,50,50,50,250,250,250,250,250,250,250};
						HI_U8 au8Over[16]={45,45,45,45,45,50,50,50,68,0,0,0,0,0,0,0};
						HI_U8 au8Under[16]={80,80,80,80,80,80,80,80,70,0,0,0,0,0,0,0};
						HI_BOOL au8EnLowLumaShoot[16]={0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1};
						HI_U8 au8TextureNoiseThd[16]={0,0,0,0,0,12,20,30,36,0,0,0,0,0,0,0};
						HI_U8 au8EdgeNoiseThd[16]={0,0,0,0,0,8,12,16,20,0,0,0,0,0,0,0};

						HI_MPI_ISP_GetSharpenAttr(0,&pstSharpenAttr);
						pstSharpenAttr.bEnable = HI_TRUE;
						pstSharpenAttr.enOpType = OP_TYPE_AUTO;
						memcpy(&pstSharpenAttr.stAuto.au8SharpenD,&au8SharD,16);
						memcpy(&pstSharpenAttr.stAuto.au8SharpenUd,&au8SharUd,16);
						memcpy(&pstSharpenAttr.stAuto.au8OverShoot,&au8Over,16);
						memcpy(&pstSharpenAttr.stAuto.au8UnderShoot,&au8Under,16);
						memcpy(&pstSharpenAttr.stAuto.abEnLowLumaShoot,&au8EnLowLumaShoot,16*sizeof(HI_BOOL));
						memcpy(&pstSharpenAttr.stAuto.au8TextureNoiseThd,&au8TextureNoiseThd,16);
						memcpy(&pstSharpenAttr.stAuto.au8EdgeNoiseThd,&au8EdgeNoiseThd,16);
						HI_MPI_ISP_SetSharpenAttr(0,&pstSharpenAttr);
					}
					if(sensorid ==SENSOR_OV2735)
					{
						isp_acm_set_ov2735(TRUE);

						ISP_SHARPEN_ATTR_S pstSharpenAttr;
						HI_U8 au8SharD[16]={110, 112, 110, 122,  125,  115,  105,  95,    95,  60,  50,   50,   50,   50,    50,    50}; 
						HI_U8 au8SharUd[16]={92,  82,  65,  60,  50,  45,  35,  30,    25,  15,  15,   15,   15,   15,    15,    15};
						// HI_U8 au8Over[16]={48,  48,  48,  48,  50,  50,  55,   55,  40,  40,   50,    50,   50,    50,    50,      50};/*overshootAmt*/
						//HI_U8 au8Under[16]={105, 95, 95, 95, 115, 115, 130,  120, 70,  0,   0,    0,   0,    0,    0,     0};/*undershootAmt*/
						HI_U8 au8Over[16]={43,  48,	48,  52,  53,  53,	46,   45,  40,	40,   50,	 50,   50,	  50,	 50,	  50};/*overshootAmt*/
						HI_U8 au8Under[16]={90, 95, 95, 112, 115, 120, 115,  110, 70,  0,	0,	  0,   0,	 0,    0,	  0};/*undershootAmt*/
						HI_MPI_ISP_GetSharpenAttr(0,&pstSharpenAttr);
						pstSharpenAttr.bEnable = HI_TRUE;
						pstSharpenAttr.enOpType = OP_TYPE_AUTO;
						memcpy(&pstSharpenAttr.stAuto.au8SharpenD,&au8SharD,16);
						memcpy(&pstSharpenAttr.stAuto.au8SharpenUd,&au8SharUd,16);
						memcpy(&pstSharpenAttr.stAuto.au8OverShoot,&au8Over,16);
						memcpy(&pstSharpenAttr.stAuto.au8UnderShoot,&au8Under,16);

						HI_MPI_ISP_SetSharpenAttr(0,&pstSharpenAttr);

						ISP_EXPOSURE_ATTR_S stExpAttr;
						HI_MPI_ISP_GetExposureAttr(IspDev, &stExpAttr);
						stExpAttr.stAuto.stSysGainRange.u32Max = 62*1024;//118*1024;
						stExpAttr.u8AERunInterval =1;
						HI_MPI_ISP_SetExposureAttr(IspDev, &stExpAttr);

						if(HWTYPE_MATCH(HW_TYPE_V3))
						{			
							HI_U16 dpc_slope[16] = {80,80,100,200,210,238,248,248,248,252,252,252,252,252,252,252};
							ISP_DP_DYNAMIC_ATTR_S  pstDPDynamicAttr;
							HI_MPI_ISP_GetDPDynamicAttr(0, &pstDPDynamicAttr);
							pstDPDynamicAttr.bEnable=HI_TRUE;
							pstDPDynamicAttr.enOpType=OP_TYPE_AUTO;
							memcpy(pstDPDynamicAttr.stAuto.au16Slope,dpc_slope,16*2);
							HI_MPI_ISP_SetDPDynamicAttr(0,&pstDPDynamicAttr);
						}

					}
					if(sensorid == SENSOR_SC2235)
					{
						ISP_SHARPEN_ATTR_S pstSharpenAttr;
						HI_U8 au8SharD[16]={140,130,130,140,140,130,120,110,100,100,100,100,100,100,100,100}; 
						HI_U8 au8SharUd[16]={115,115,115,115,105,95,88,78,50,50,50,50,50,50,50,50};
						HI_U8 au8Over[16]={45,50,50,50,50,50,48,48,50,50,50,50,50,50,50,50};
						HI_U8 au8Under[16]={95,100,105,115,120,115,110,105,100,100,100,100,100,100,100,100};
						HI_BOOL au8EnLowLumaShoot[16]={0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1};
						HI_U8 au8TextureNoiseThd[16]={8,9,15,20,25,28,30,32,25,25,25,25,25,25,25,25};
						HI_U8 au8EdgeNoiseThd[16]={0,0,0,2,5,7,8,10,10,10,10,10,10,10,10,10};

						HI_MPI_ISP_GetSharpenAttr(0,&pstSharpenAttr);
						pstSharpenAttr.bEnable = HI_TRUE;
						pstSharpenAttr.enOpType = OP_TYPE_AUTO;
						memcpy(&pstSharpenAttr.stAuto.au8SharpenD,&au8SharD,16);
						memcpy(&pstSharpenAttr.stAuto.au8SharpenUd,&au8SharUd,16);
						memcpy(&pstSharpenAttr.stAuto.au8OverShoot,&au8Over,16);
						memcpy(&pstSharpenAttr.stAuto.au8UnderShoot,&au8Under,16);
						memcpy(&pstSharpenAttr.stAuto.abEnLowLumaShoot,&au8EnLowLumaShoot,16*sizeof(HI_BOOL));
						memcpy(&pstSharpenAttr.stAuto.au8TextureNoiseThd,&au8TextureNoiseThd,16);
						memcpy(&pstSharpenAttr.stAuto.au8EdgeNoiseThd,&au8EdgeNoiseThd,16);
						HI_MPI_ISP_SetSharpenAttr(0,&pstSharpenAttr);
						isp_acm_set_sc2235(TRUE);
						ISP_EXPOSURE_ATTR_S stExpAttr;
						HI_MPI_ISP_GetExposureAttr(IspDev, &stExpAttr);
						stExpAttr.stAuto.stSysGainRange.u32Max = 128*1024;//118*1024;
						stExpAttr.u8AERunInterval =1;
						HI_MPI_ISP_SetExposureAttr(IspDev, &stExpAttr);

						/*ISP_COLOR_TONE_ATTR_S  pstCTAttr;
						  HI_MPI_ISP_GetColorToneAttr(0, &pstCTAttr);
						  pstCTAttr.u16RedCastGain = 256;
						  pstCTAttr.u16GreenCastGain = 262;
						  pstCTAttr.u16BlueCastGain = 259;
						  HI_MPI_ISP_SetColorToneAttr(0, &pstCTAttr);*/
					}
				}
				else if(DEFAULT == value)
				{

				}
				else if(MODE1== value)
				{

				}
				break;
			}
		case ADJ_BRIGHTNESS://设置亮度
			{
				if(value <0||value > 255)
					return -1;
				user_set_luma  = value;
				ISP_EXPOSURE_ATTR_S stExpAttr;
				HI_MPI_ISP_GetExposureAttr(IspDev, &stExpAttr);

				signed int value_cal =64;
				if(nightflag)		
					value_cal = user_set_luma -LINE_NIGHT_LUM;
				else
					value_cal = user_set_luma -LINE_DAY_LUM;

				if(sensorid == SENSOR_OV2710)
				{
					if(nightflag)		
						value_cal = user_set_luma -LINE_HOME_NIGHT_LUM;
					else
						value_cal = user_set_luma -LINE_HOME_DAY_LUM;
				}
				if(sensorid == SENSOR_AR0130)
				{
					if(nightflag)		
						value_cal = user_set_luma -68;
					else
						value_cal = user_set_luma -68;
				}
				if(sensorid == SENSOR_OV2735)
				{
					if(nightflag)		
						value_cal = user_set_luma -78;
					else
						value_cal = user_set_luma -73;
				}
				if(sensorid == SENSOR_SC2235)
				{
					if(nightflag)		
						value_cal = user_set_luma -83;
					else
						value_cal = user_set_luma -68;
				}
				if(value_cal<0)
					value_cal =0;
				stExpAttr.stAuto.u8Compensation = value_cal;
				HI_MPI_ISP_SetExposureAttr(IspDev, &stExpAttr);
				break;
			}
		case ADJ_SATURATION://设置饱和度
			{
				signed int auSat[16];
				signed int tmpSat;
				if(value >255 || value <0)
					return -1;

				ISP_SATURATION_ATTR_S pstSatAttr;
				HI_MPI_ISP_GetSaturationAttr(IspDev, &pstSatAttr);
				pstSatAttr.enOpType = OP_TYPE_AUTO;
				//pstSatAttr.stManual.u8Saturation = value;

				if(sensorid == SENSOR_OV9750||sensorid == SENSOR_OV9750m)
				{
					tmpSat =  value;
					auSat[0] = tmpSat-0;       //128
					auSat[1] = tmpSat-0;       //128
					auSat[2] = tmpSat-0;     //128
					auSat[3] = tmpSat-0;    //128
					auSat[4] = tmpSat-20;    //108
					auSat[5] = tmpSat-38;    //90
					auSat[6] = tmpSat-48;    //88 
					auSat[7] = tmpSat-58;    //78
					auSat[8] = tmpSat-58;    //68
					auSat[9] = tmpSat-58;    //68 
					auSat[10] = tmpSat-58;    //68
					auSat[11] = tmpSat-58;    //68
					auSat[12] = tmpSat-58;    //68
					auSat[13] = tmpSat-58;    //68
					auSat[14] = tmpSat-58;    //68
					auSat[15] = tmpSat-58;    //68	   
				}
				else if(sensorid == SENSOR_OV9732)
				{
					tmpSat =value;					
					auSat[0] = tmpSat;       
					auSat[1] = tmpSat;      
					auSat[2] = tmpSat-8;      
					auSat[3] = tmpSat-16;       
					auSat[4] = tmpSat-38;    
					auSat[5] = tmpSat-53;    
					auSat[6] = tmpSat-68;     
					auSat[7] = tmpSat-78;
					auSat[8] = tmpSat-78; 
					auSat[9] = tmpSat-78; 
					auSat[10] = tmpSat-78; 
					auSat[11] = tmpSat-78; 
					auSat[12] = tmpSat-78; 
					auSat[13] = tmpSat-78; 
					auSat[14] = tmpSat-78; 
					auSat[15] = tmpSat-78; 
				}
				else if(sensorid == SENSOR_MN34227)
				{
					tmpSat =  value;
					auSat[0] = tmpSat;       //128
					auSat[1] = tmpSat;       //128
					auSat[2] = tmpSat;       //128
					auSat[3] = tmpSat-10;    //118

					auSat[4] = tmpSat-28;    //100
					auSat[5] = tmpSat-43;    //85
					auSat[6] = tmpSat-48;    //80
					auSat[7] = tmpSat-48;    //80
					auSat[8] = tmpSat-50;    //78
					auSat[9] = tmpSat-55;    //73 
					auSat[10] = tmpSat-60;    //68
					auSat[11] = tmpSat-60;    //68
					auSat[12] = tmpSat-60;    //68
					auSat[13] = tmpSat-60;    //68
					auSat[14] = tmpSat-60;    //68
					auSat[15] = tmpSat-60;    //68	   
				}
#if 0
				if(sensorid == SENSOR_OV2710)
				{
					tmpSat =  value;
					auSat[0] = tmpSat;       //128
					auSat[1] = tmpSat-5;     //128
					auSat[2] = tmpSat-10;     //128
					auSat[3] = tmpSat-18;    //128
					auSat[4] = tmpSat-38;    //108
					auSat[5] = tmpSat-70;    //90
					auSat[6] = tmpSat-88;    //88 
					auSat[7] = tmpSat-88;    //78
					auSat[8] = tmpSat-88;    //68
					auSat[9] = tmpSat-88;    //68 
					auSat[10] = tmpSat-58;    //68
					auSat[11] = tmpSat-58;    //68
					auSat[12] = tmpSat-58;    //68
					auSat[13] = tmpSat-58;    //68
					auSat[14] = tmpSat-58;    //68
					auSat[15] = tmpSat-58;    //68	   
				}
#else
				if(sensorid == SENSOR_OV2710)
				{
					tmpSat =  value;
					auSat[0] = tmpSat;       //118
					auSat[1] = tmpSat;       //118
					auSat[2] = tmpSat;       //103
					auSat[3] = tmpSat-10;    //50

					auSat[4] = tmpSat-24;    //40
					auSat[5] = tmpSat-42;    //30
					auSat[6] = tmpSat-56;    //28
					auSat[7] = tmpSat-80;    //10
					auSat[8] = tmpSat-80;    //68
					auSat[9] = tmpSat-80;    //68 
					auSat[10] = tmpSat-80;    //68
					auSat[11] = tmpSat-80;    //68
					auSat[12] = tmpSat-80;    //68
					auSat[13] = tmpSat-80;    //68
					auSat[14] = tmpSat-80;    //68
					auSat[15] = tmpSat-80;    //68	   
				}
#endif
				if(sensorid == SENSOR_SC2135)
				{
					tmpSat =  value;
					auSat[0] = tmpSat;       //118
					auSat[1] = tmpSat;       //118
					auSat[2] = tmpSat;       //103
					auSat[3] = tmpSat-10;    //50

					auSat[4] = tmpSat-24;    //40
					auSat[5] = tmpSat-42;    //30
					auSat[6] = tmpSat-56;    //28
					auSat[7] = tmpSat-80;    //10
					auSat[8] = tmpSat-80;    //68
					auSat[9] = tmpSat-80;    //68 
					auSat[10] = tmpSat-80;    //68
					auSat[11] = tmpSat-80;    //68
					auSat[12] = tmpSat-80;    //68
					auSat[13] = tmpSat-80;    //68
					auSat[14] = tmpSat-80;    //68
					auSat[15] = tmpSat-80;    //68	   
				}
				if(sensorid == SENSOR_AR0130)
				{
					tmpSat =  value;
					auSat[0] = tmpSat+0;       //128
					auSat[1] = tmpSat+0;       //128
					auSat[2] = tmpSat-5;     //128
					auSat[3] = tmpSat-10;    //128
					auSat[4] = tmpSat-30;    //108
					auSat[5] = tmpSat-48;    //90
					auSat[6] = tmpSat-58;    //88 
					auSat[7] = tmpSat-58;    //78
					auSat[8] = tmpSat-58;    //68
					auSat[9] = tmpSat-58;    //68 
					auSat[10] = tmpSat-58;    //68
					auSat[11] = tmpSat-58;    //68
					auSat[12] = tmpSat-58;    //68
					auSat[13] = tmpSat-58;    //68
					auSat[14] = tmpSat-58;    //68
					auSat[15] = tmpSat-58;    //68	   
				}
				if(sensorid == SENSOR_SC2045)
				{
					tmpSat =  value;
					auSat[0] = tmpSat;       
					auSat[1] = tmpSat;      
					auSat[2] = tmpSat-8;      
					auSat[3] = tmpSat-20;   

					auSat[4] = tmpSat-38;   
					auSat[5] = tmpSat-53;   
					auSat[6] = tmpSat-64;   
					auSat[7] = tmpSat-80;   
					auSat[8] = tmpSat-80;    //68
					auSat[9] = tmpSat-80;    //68 
					auSat[10] = tmpSat-80;    //68
					auSat[11] = tmpSat-80;    //68
					auSat[12] = tmpSat-80;    //68
					auSat[13] = tmpSat-80;    //68
					auSat[14] = tmpSat-80;    //68
					auSat[15] = tmpSat-80;    //68	   
				}
				if(sensorid == SENSOR_OV2735)
				{
					tmpSat =  value;
					auSat[0] = tmpSat;       //128
					auSat[1] = tmpSat;       //128
					auSat[2] = tmpSat;       //128
					auSat[3] = tmpSat-10;    //118

					auSat[4] = tmpSat-28;    //100
					auSat[5] = tmpSat-42;    //86
					auSat[6] = tmpSat-63;    //65
					auSat[7] = tmpSat-65;    //64
					auSat[8] = tmpSat-70;    //58
					auSat[9] = tmpSat-80;    //68 
					auSat[10] = tmpSat-80;    //68
					auSat[11] = tmpSat-80;    //68
					auSat[12] = tmpSat-80;    //68
					auSat[13] = tmpSat-80;    //68
					auSat[14] = tmpSat-80;    //68
					auSat[15] = tmpSat-80;    //68	   
				}
				if(sensorid == SENSOR_SC2235)
				{
					tmpSat =  value;
					auSat[0] = tmpSat+5;       //128
					auSat[1] = tmpSat+5;       //128
					auSat[2] = tmpSat+5;       //128
					auSat[3] = tmpSat-10+5;    //118

					auSat[4] = tmpSat-28+5;    //100
					auSat[5] = tmpSat-42+5;    //86
					auSat[6] = tmpSat-63+5;    //65
					auSat[7] = tmpSat-65+5;    //64
					auSat[8] = tmpSat-70+5;    //58
					auSat[9] = tmpSat-80+5;    //68 
					auSat[10] = tmpSat-80;    //68
					auSat[11] = tmpSat-80;    //68
					auSat[12] = tmpSat-80;    //68
					auSat[13] = tmpSat-80;    //68
					auSat[14] = tmpSat-80;    //68
					auSat[15] = tmpSat-80;    //68	   
				}
				int i;
				for(i=0;i<16;i++)
				{
					if( auSat[i]>255)
						auSat[i]=255;
					if( auSat[i]<0)
						auSat[i]=0;	
					pstSatAttr.stAuto.au8Sat[i] = (HI_U8)auSat[i];
				}

				HI_MPI_ISP_SetSaturationAttr(IspDev, &pstSatAttr);
				break;
			}
		case ADJ_CONTRAST://设置对比度
			{
				if(value >255 || value <0)
					return -1;
				user_set_contrast =value;
				if(nightflag)	
				{
					if(sensorid == SENSOR_SC2235)
						printf("set sensor night gamma.\n");
					else
						return 0;
				}
				ISP_GAMMA_ATTR_S pstGammaAttr;
				pstGammaAttr.bEnable = HI_TRUE;
				pstGammaAttr.enCurveType = ISP_GAMMA_CURVE_USER_DEFINE;
				if(sensorid == SENSOR_OV9750||sensorid == SENSOR_OV9750m)
				{
					{
						if(value > 200)
						{
							user_select_gamma =3;
							memcpy(&pstGammaAttr.u16Table,&V200_LINE_NIGHT_LV0_GAMMA,257 * 2);
						}
						else if(value < 70)
						{
							memcpy(&pstGammaAttr.u16Table,&V200_LINE_DAY_LV1_GAMMA,257 * 2);
							user_select_gamma =1;
						}
						else
						{
							memcpy(&pstGammaAttr.u16Table,&V200_LINE_DAY_LV0_GAMMA,257 * 2);
							user_select_gamma =2;
						}
					}

				}
				else if(sensorid == SENSOR_OV9732)
				{	
					if(value > 200)
					{
						user_select_gamma =3;
						//ov9732_gamma = 3;
						memcpy(&pstGammaAttr.u16Table,&V200_LINE_NIGHT_LV0_GAMMA,257 * 2);
					}
					else if(value < 70)
					{
						memcpy(&pstGammaAttr.u16Table,&V200_LINE_DAY_LV2_GMMMA,257 * 2);
						//ov9732_gamma = 1;
						user_select_gamma =1;
					}
					else
					{
						memcpy(&pstGammaAttr.u16Table,&OV4689_LINE_GAMMA,257 * 2);
						//ov9732_gamma = 2;
						user_select_gamma =2;
					}
				}
#if 0
				if(sensorid == SENSOR_OV2710)
				{
					{
						if(value > 200)
						{
							user_select_gamma =3;
							memcpy(&pstGammaAttr.u16Table,&V200_LINE_NIGHT_LV0_GAMMA,257 * 2);
						}
						else if(value < 70)
						{
							memcpy(&pstGammaAttr.u16Table,&V200_LINE_DAY_LV1_GAMMA,257 * 2);
							user_select_gamma =1;
						}
						else
						{
							memcpy(&pstGammaAttr.u16Table,&u16Gamma_2710_day,257 * 2);
							user_select_gamma =2;
						}
					}
				}				
#else
				if(sensorid == SENSOR_OV2710||sensorid == SENSOR_OV2735||sensorid == SENSOR_MN34227)
				{
					if(value > 200)
					{
						user_select_gamma =3;
						memcpy(&pstGammaAttr.u16Table,&V200_LINE_DAY_LV1_GAMMA,257 * 2);
					}
					else if(value < 70)
					{
						memcpy(&pstGammaAttr.u16Table,&V200_LINE_DAY_LV2_GMMMA,257 * 2);
						user_select_gamma =1;
					}
					else
					{
						memcpy(&pstGammaAttr.u16Table,&v200_day_gammaM,257 * 2);
						user_select_gamma =2;
					}
				}
#endif
				if(sensorid == SENSOR_SC2135)
				{
					if(value > 200)
					{
						user_select_gamma =3;
						memcpy(&pstGammaAttr.u16Table,&V200_LINE_DAY_LV0_GAMMA,257 * 2);
					}
					else if(value < 70)
					{
						memcpy(&pstGammaAttr.u16Table,&V200_LINE_DAY_LV2_GMMMA,257 * 2);
						user_select_gamma =1;
					}
					else
					{
						memcpy(&pstGammaAttr.u16Table,&V200_LINE_DAY_LV0_GAMMA,257 * 2);
						user_select_gamma =2;
					}
				}
				if(sensorid == SENSOR_AR0130)
				{
					{
						if(value > 200)
						{
							user_select_gamma =3;
							memcpy(&pstGammaAttr.u16Table,&V200_LINE_NIGHT_LV0_GAMMA,257 * 2);
						}
						else if(value < 70)
						{
							memcpy(&pstGammaAttr.u16Table,&V200_LINE_DAY_LV1_GAMMA,257 * 2);
							user_select_gamma =1;
						}
						else
						{
							memcpy(&pstGammaAttr.u16Table,&u16Gamma_ar0130_day,257 * 2);
							user_select_gamma =2;
						}
					}
				}
				if(sensorid == SENSOR_SC2045)
				{				
					{
						if(value > 200)
						{
							user_select_gamma =3;
							memcpy(&pstGammaAttr.u16Table,&V200_LINE_NIGHT_LV0_GAMMA,257 * 2);
						}
						else if(value < 70)
						{
							memcpy(&pstGammaAttr.u16Table,&V200_LINE_DAY_LV2_GMMMA,257 * 2);
							user_select_gamma =1;
						}
						else
						{
							memcpy(&pstGammaAttr.u16Table,&OV4689_LINE_GAMMA,257 * 2);
							user_select_gamma =2;
						}
					}
				}
				if(sensorid == SENSOR_SC2235)
				{
					if(nightflag)
					{
						if(value > 200)
						{
							user_select_gamma =3;
							memcpy(&pstGammaAttr.u16Table,&v200_night_gammaH,257 * 2);
						}
						else if(value < 70)
						{
							memcpy(&pstGammaAttr.u16Table,&v200_day_gammaM,257 * 2);
							user_select_gamma =1;
						}
						else
						{
							memcpy(&pstGammaAttr.u16Table,&v200_night_gammaM,257 * 2);
							user_select_gamma =2;
						}
					}
					else
					{
						if(value > 200)
						{
							user_select_gamma =3;
							memcpy(&pstGammaAttr.u16Table,&v200_day_gammaH,257 * 2);
						}
						else if(value < 70)
						{
							memcpy(&pstGammaAttr.u16Table,&V200_LINE_DAY_LV2_GMMMA,257 * 2);
							user_select_gamma =1;
						}
						else
						{
							memcpy(&pstGammaAttr.u16Table,&v200_day_gammaM,257 * 2);
							user_select_gamma =2;
						}
					}
				}
				HI_MPI_ISP_SetGammaAttr(IspDev,&pstGammaAttr);								
				break;
			}
		case  ADJ_COLOURMODE:
			{
				ISP_SATURATION_ATTR_S pstSatAttr;
				HI_MPI_ISP_GetSaturationAttr(IspDev, &pstSatAttr);
				if(value == 1)//彩色模式
				{
					pstSatAttr.enOpType = OP_TYPE_AUTO;
					HI_MPI_ISP_SetSaturationAttr(IspDev, &pstSatAttr);
				}
				else           //黑白色
				{
					pstSatAttr.enOpType = OP_TYPE_MANUAL;
					pstSatAttr.stManual.u8Saturation = 0x0;
					HI_MPI_ISP_SetSaturationAttr(IspDev, &pstSatAttr);
				}
				break;
			}
		case ADJ_SHARPNESS:
			{
				signed int uu_value=400; 
				if(sensorid == SENSOR_OV9750||sensorid == SENSOR_OV9750m||sensorid == SENSOR_OV9732||sensorid == SENSOR_OV2710||sensorid == SENSOR_SC2045||sensorid == SENSOR_SC2135||sensorid == SENSOR_OV2735 || sensorid == SENSOR_SC2235)//不允许设置 
				{
					uu_value = -1;
				}

				if(uu_value>=0)
				{
					if(uu_value > 1023)
						uu_value = 1023;

					ISP_DEMOSAIC_ATTR_S pstDemosaicAttr;

					HI_MPI_ISP_GetDemosaicAttr(IspDev, &pstDemosaicAttr);
					pstDemosaicAttr.u16UuSlope=uu_value;
					HI_MPI_ISP_SetDemosaicAttr(IspDev, &pstDemosaicAttr);
				}
				break;
			}
		case SFHDR_SW:
			{
				break;
			}
		case MIRROR_TURN:
			{
				if(value==0)
					VI_Mirror_Flip(HI_FALSE,HI_FALSE);
				if(value==1)
					VI_Mirror_Flip(HI_TRUE,HI_FALSE);
				if(value==2)
					VI_Mirror_Flip(HI_FALSE,HI_TRUE);
				if(value==3)
					VI_Mirror_Flip(HI_TRUE,HI_TRUE);
				break;
			}
		case PFI_SW:
			{
				if(value==PFI_ON)
				{/*
					ISP_IMAGE_ATTR_S pstImageAttr;
					HI_MPI_ISP_GetImageAttr(IspDev, &pstImageAttr);
					pstImageAttr.u16FrameRate =25;
					HI_MPI_ISP_SetImageAttr(IspDev, &pstImageAttr);*/
				}
				if(value == PFI_OFF)
				{/*
					ISP_IMAGE_ATTR_S pstImageAttr;
					HI_MPI_ISP_GetImageAttr(IspDev, &pstImageAttr);
					pstImageAttr.u16FrameRate =30;
					HI_MPI_ISP_SetImageAttr(IspDev, &pstImageAttr);*/
				}
				break;
			}
		case LOW_FRAME:
			{
				//HI_MPI_ISP_SetSlowFrameRate(value);
				break;
			}
		case WDR_SW:
			{
				if (sensorid == SENSOR_OV4689)
				{
					if(value==0) //关闭wdr
					{
						sensor_wdr_flag =0;
						jv_sensor_wdr_switch(0);
					}
					else
					{
						sensor_wdr_flag =1;
						jv_sensor_wdr_switch(1);
					}
				}
				else
				{
					ISP_DRC_ATTR_S pstDRCAttr;
					HI_MPI_ISP_GetDRCAttr(IspDev, &pstDRCAttr);
					if(value ==1)
					{
						pstDRCAttr.bEnable = HI_TRUE;
						pstDRCAttr.enOpType = OP_TYPE_MANUAL;
						pstDRCAttr.stManual.u8Strength =70;
						pstDRCAttr.u8Asymmetry=7;
						pstDRCAttr.u8SecondPole=180;
						pstDRCAttr.u8Stretch=55;
						/*
						   DRCStrengthTarget = 128
						   DRCu16BrightGainLmt = 127
						   DRCu16DarkGainLmtC = 127
						   DRCu16DarkGainLmtY = 127
						   DRCu8Asymmetry = 2
						   DRCu8LocalMixingBrigtht = 45
						   DRCu8LocalMixingDark = 45
						   DRCu8LocalMixingThres = 2
						   DRCu8RangeVar = 0
						   DRCu8SecondPole = 180
						   DRCu8SpatialVar = 10
						   DRCu8Stretch = 54*/
					}
					else
						pstDRCAttr.bEnable = HI_FALSE;
					HI_MPI_ISP_SetDRCAttr(IspDev, &pstDRCAttr);      //关闭软件HDR
				}
				break;
			}
#endif
		case GET_ID:
			{
				int ret = 0;	
				int tmp_sensorid = SENSOR_UNKNOWN;			 
				if(sensorType != SENSOR_UNKNOWN)
				{
					*(int *)value = sensorid =sensorType;
					return 0;
				}

				if( *(int *)value > SENSOR_UNKNOWN &&  *(int *)value < SENSOR_MAX )
					tmp_sensorid = *(int *)value;
				else
					tmp_sensorid = SENSOR_UNKNOWN;

				//平台当前兼容sensor数量
				int sensor_num = sizeof(Check_Sensor)/sizeof(Check_Sensor[1]);
				int i = 0;

				//预检测确认sensor类型
				Pre_Check_Sensor();
				//二次启动及之后 ( sensor.sh文件存在)
				if(SENSOR_UNKNOWN != tmp_sensorid)
				{
					for(i=0;i<sensor_num;i++)
					{
						if(Check_Sensor[i].SensorType == tmp_sensorid)
						{
							if(Check_Sensor[i].CommType == I2C)
								ret = reg_i2c_read(Check_Sensor[i].I2c_Attr.device_addr,Check_Sensor[i].I2c_Attr.reg_addr,Check_Sensor[i].I2c_Attr.reg_width,Check_Sensor[i].I2c_Attr.data_width);
							else
								ret = reg_spi_read(Check_Sensor[i].spi_id_reg);
							//如果sensor信息与当前信息相符，则返回
							if(Check_Sensor[i].Id_Reg_Value == ret && Check_Sensor[i].Check_Flag)
							{
								*(int *)value = Check_Sensor[i].SensorType;
								sensorType = sensorid = Check_Sensor[i].SensorType;   
								if(sensorType ==SENSOR_OV2735)
								{
									ret = reg_i2c_read(0x78,0x4,1,1);
									if(ret ==0x6 ||ret ==0x7)
										bOV2735B =TRUE;
								}
								printf("========read sensor id : %s========\n",Check_Sensor[i].Sensor_Name);
								return 0;
							}
							else//如果sensor信息与原来存储信息不符，则重新轮询一遍
							{	
								if(tmp_sensorid != SENSOR_UNKNOWN)
								{
									tmp_sensorid = SENSOR_UNKNOWN;
									break;
								}
							}
						}
					}
				}

				//首次启动(sensor.sh文件不存在，或者文件内容与i2c读出信息不符)
				if(SENSOR_UNKNOWN == tmp_sensorid)
				{
					//首次轮询判断设备名
					for(i=0;i<sensor_num;i++)
					{	
						if( Check_Sensor[i].Check_Flag )
						{
							if(Check_Sensor[i].CommType == I2C)
								ret = reg_i2c_read(Check_Sensor[i].I2c_Attr.device_addr,Check_Sensor[i].I2c_Attr.reg_addr,Check_Sensor[i].I2c_Attr.reg_width,Check_Sensor[i].I2c_Attr.data_width);
							else
								ret = reg_spi_read(Check_Sensor[i].spi_id_reg);
							//如果sensor信息与当前信息相符，则返回
							if(Check_Sensor[i].Id_Reg_Value == ret)
							{
								*(int *)value = Check_Sensor[i].SensorType;
								sensorType = sensorid = Check_Sensor[i].SensorType;
								if(sensorType ==SENSOR_OV2735)
								{
									ret = reg_i2c_read(0x78,0x4,1,1);
									if(ret ==0x6 ||ret ==0x7)
										bOV2735B =TRUE;
								}
								printf("========read sensor id : %s========\n",Check_Sensor[i].Sensor_Name);
								return 0;
							}
						}
					}
				}
			}
			//匹配不成功
			*(int *)value = SENSOR_UNKNOWN;
			sensorType = sensorid = SENSOR_UNKNOWN;   
			printf("=======read sensor id error========\n");	
			return 0;
			break;
		default:
			break;
	}
	return 0;
}

int __base_isp_set_fps(float frameRate)
{
	if(frameRate >= 2)
	{
		ISP_PUB_ATTR_S stPubAttr;
		HI_MPI_ISP_GetPubAttr(0, &stPubAttr);	
		stPubAttr.f32FrameRate = frameRate;
		HI_MPI_ISP_SetPubAttr(0, &stPubAttr);
		CURRENT_SENSOR_FPS =stPubAttr.f32FrameRate;
		printf("set sensor %f fps.\n",CURRENT_SENSOR_FPS);
	}
	return 0;
}

float isp_get_fps()
{

	return CURRENT_SENSOR_FPS;
}

int isp_get_std_fps()
{

	return USER_SENSOR_FPS;
}


BOOL isp_check_low_fps()
{
	BOOL bLow = (LowFpsRatio == 16 ? FALSE:TRUE);
	return bLow;
}


int isp_set_low_fps(int ratio)
{
	if (ratio<=0)
		return 0;
	
	pthread_mutex_lock(&isp_rf_mutex);
	
	float nFps= (float)USER_SENSOR_FPS*16/ratio;//使用
	nFps = ((float)((int)((nFps+0.05)*10)))/10;//保留小数点1位
	 __base_isp_set_fps(nFps);
	LowFpsRatio = ratio;
	pthread_mutex_unlock(&isp_rf_mutex);
	return 0;
}


int isp_set_std_fps(int fps)
{

	pthread_mutex_lock(&isp_rf_mutex);
	
	float nFps= (float)fps*16/LowFpsRatio;
	nFps = ((float)((int)((nFps+0.05)*10)))/10;//保留小数点1位
	 __base_isp_set_fps(nFps);
	 
	USER_SENSOR_FPS = fps;
	
	pthread_mutex_unlock(&isp_rf_mutex);
	return 0;
}




int isp_exposure_set(EXPOSURE_DATA * pdata)
{
	ISP_DEV IspDev = 0;
	ISP_EXPOSURE_ATTR_S stExpAttr;

	HI_MPI_ISP_GetExposureAttr(IspDev, &stExpAttr);
	//stExpAttr.enOpType = pdata->type;
	//stExpAttr.stManual.enExpTimeOpType = pdata->bManualExpLineEnable;
	//stExpAttr.stManual.u32ExpTime = pdata->u32ExpLine;
	//stExpAttr.stManual.enAGainOpType = pdata->bManualAGainEnable;
	//stExpAttr.stManual.u32AGain = pdata->s32AGain;
	//stExpAttr.stManual.enDGainOpType = pdata->bManualDGainEnable;
	//stExpAttr.stManual.u32DGain = pdata->s32DGain;
	//stExpAttr.stManual.enISPDGainOpType = pdata->bManualISPDGainEnable;
	//stExpAttr.stManual.u32ISPDGain = pdata->u32ISPDGain;
	//stExpAttr.stAuto.enAEMode = pdata->enAEMode;
	//stExpAttr.stAuto.u8Tolerance = pdata->s16ExpTolerance;
	//stExpAttr.stAuto.stAGainRange.u32Max = pdata->u16AGainMax;
	//stExpAttr.stAuto.stAGainRange.u32Min = pdata->u16AGainMin;
	//stExpAttr.stAuto.stDGainRange.u32Max = pdata->u16DGainMax;
	//stExpAttr.stAuto.stDGainRange.u32Min = pdata->u16DGainMin;
	//stExpAttr.stAuto.stExpTimeRange.u32Max = pdata->u16ExpTimeMax;
	//stExpAttr.stAuto.stExpTimeRange.u32Min = pdata->u16ExpTimeMin;
	//stExpAttr.stAuto.u8Compensation = pdata->u8ExpCompensation;
	//stExpAttr.stAuto.u8Speed = pdata->u8ExpStep;
	memcpy(&(stExpAttr.stAuto.au8Weight),&(pdata->u8Weight),AE_ZONE_ROW*AE_ZONE_COLUMN);
	CHECK_RET(HI_MPI_ISP_SetExposureAttr(IspDev, &stExpAttr));

	return 0;
}

int isp_exposure_get(EXPOSURE_DATA * pdata)
{
	ISP_DEV IspDev = 0;
	ISP_EXPOSURE_ATTR_S stExpAttr;

	HI_MPI_ISP_GetExposureAttr(IspDev, &stExpAttr);
	pdata->type = stExpAttr.enOpType;
	pdata->s32AGain = stExpAttr.stManual.u32AGain;
	pdata->s32DGain = stExpAttr.stManual.u32DGain;
	pdata->u32ExpLine = stExpAttr.stManual.u32ExpTime;
	pdata->u32ISPDGain = stExpAttr.stManual.u32ISPDGain;
	pdata->bManualExpLineEnable = stExpAttr.stManual.enExpTimeOpType;
	pdata->bManualAGainEnable = stExpAttr.stManual.enAGainOpType;
	pdata->bManualDGainEnable = stExpAttr.stManual.enDGainOpType;
	pdata->bManualISPDGainEnable = stExpAttr.stManual.enISPDGainOpType;
	pdata->enAEMode = stExpAttr.stAuto.enAEMode;
	pdata->u16ExpTimeMax = stExpAttr.stAuto.stExpTimeRange.u32Max;
	pdata->u16ExpTimeMin = stExpAttr.stAuto.stExpTimeRange.u32Min;
	pdata->u16DGainMax = stExpAttr.stAuto.stDGainRange.u32Max;
	pdata->u16DGainMin = stExpAttr.stAuto.stDGainRange.u32Min;
	pdata->u16AGainMax = stExpAttr.stAuto.stAGainRange.u32Max;
	pdata->u16AGainMin = stExpAttr.stAuto.stAGainRange.u32Min;
	pdata->u8ExpStep = stExpAttr.stAuto.u8Speed;
	pdata->s16ExpTolerance = stExpAttr.stAuto.u8Tolerance;
	pdata->u8ExpCompensation = stExpAttr.stAuto.u8Compensation;
	memcpy(&(pdata->u8Weight),&(stExpAttr.stAuto.au8Weight),AE_ZONE_ROW*AE_ZONE_COLUMN);

	return 0;
}



int isp_wb_set(WB_DATA *pdata)
{
	ISP_DEV IspDev = 0;
	ISP_WB_ATTR_S stWBAttr;

	HI_MPI_ISP_GetWBAttr(IspDev, &stWBAttr);
	stWBAttr.enOpType = pdata->type;
	stWBAttr.stManual.u16Bgain = pdata->u16Bgain;
	//stWBAttr.stManual.u16Grgain = pdata->u16Ggain;
	//stWBAttr.stManual.u16Gbgain = pdata->u16Ggain;
	stWBAttr.stManual.u16Rgain = pdata->u16Rgain;
	stWBAttr.stAuto.bEnable = HI_TRUE;
	stWBAttr.stAuto.u8BGStrength = pdata->u8BGStrength;
	stWBAttr.stAuto.u8RGStrength = pdata->u8RGStrength;    
	stWBAttr.stAuto.u16ZoneSel = pdata->u8ZoneSel;
	stWBAttr.stAuto.u16HighColorTemp = pdata->u8HighColorTemp;
	stWBAttr.stAuto.u16LowColorTemp = pdata->u8LowColorTemp;
	HI_MPI_ISP_SetWBAttr(IspDev, &stWBAttr);

	return 0;
}

int isp_wb_get(WB_DATA * pdata)
{
	ISP_DEV IspDev = 0;
	ISP_WB_ATTR_S stWBAttr;

	HI_MPI_ISP_GetWBAttr(IspDev, &stWBAttr);
	pdata->type = stWBAttr.enOpType;
	pdata->u16Bgain = stWBAttr.stManual.u16Bgain;
	//pdata->u16Ggain = stWBAttr.stManual.u16Grgain;
	//pdata->u16Ggain = stWBAttr.stManual.u16Gbgain;
	pdata->u16Rgain = stWBAttr.stManual.u16Rgain;
	pdata->u8BGStrength = stWBAttr.stAuto.u8BGStrength;
	pdata->u8RGStrength = stWBAttr.stAuto.u8RGStrength;    
	pdata->u8ZoneSel = stWBAttr.stAuto.u16ZoneSel;
	pdata->u8HighColorTemp = stWBAttr.stAuto.u16HighColorTemp;
	pdata->u8LowColorTemp = stWBAttr.stAuto.u16LowColorTemp;

	return 0;
}



int isp_gamma_set(GAMMA_DATA *pdata)
{
	ISP_DEV IspDev = 0;
	ISP_GAMMA_ATTR_S stGammaAttr;

	stGammaAttr.bEnable = pdata->bEnable.bEnable;
	stGammaAttr.enCurveType = pdata->bEnable.enCurveType;
	memcpy(&stGammaAttr.u16Table,&pdata->u16Gamma,257 * 2);
	HI_MPI_ISP_SetGammaAttr(IspDev, &stGammaAttr);

	return 0;
}

int isp_gamma_get(GAMMA_DATA *pdata)
{
	ISP_DEV IspDev = 0;
	ISP_GAMMA_ATTR_S stGammaAttr;

	HI_MPI_ISP_GetGammaAttr(IspDev, &stGammaAttr);
	pdata->bEnable.bEnable = stGammaAttr.bEnable;
	pdata->bEnable.enCurveType = stGammaAttr.enCurveType;
	pdata->enGammaCurve = stGammaAttr.enCurveType;
	memcpy(&(pdata->u16Gamma),&(stGammaAttr.u16Table),257 * 2);

	return 0;
}




int isp_sharpen_set(SHARPEN_DATA *pdata)
{
	ISP_DEV IspDev = 0;
	ISP_SHARPEN_ATTR_S pstSharpenAttr;

	pstSharpenAttr.bEnable = pdata->bEnable;
	pstSharpenAttr.enOpType = pdata->bManualEnable;
	// ......
	HI_MPI_ISP_SetSharpenAttr(IspDev, &pstSharpenAttr);

	return 0;
}

int isp_sharpen_get(SHARPEN_DATA *pdata)
{
	ISP_DEV IspDev = 0;
	ISP_SHARPEN_ATTR_S pstSharpenAttr;

	HI_MPI_ISP_GetSharpenAttr(IspDev, &pstSharpenAttr);
	pdata->bEnable = pstSharpenAttr.bEnable;
	pdata->bManualEnable = pstSharpenAttr.enOpType;
	// ......

    return 0;
}



int isp_ccm_set(CCM_DATA *pdata)
{
	ISP_DEV IspDev = 0;

	ISP_SATURATION_ATTR_S pstSatAttr;
	pstSatAttr.enOpType = pdata->bSatManualEnable;
	pstSatAttr.stManual.u8Saturation = pdata->u8SatTarget;
	memcpy(pstSatAttr.stAuto.au8Sat, pdata->au8Sat, 16);
	HI_MPI_ISP_SetSaturationAttr(IspDev, &pstSatAttr);

	//HI_U32 pu32Value;
	//pu32Value = pdata->pu32Value;
	//HI_MPI_ISP_SetSaturation(pu32Value);

	ISP_COLORMATRIX_ATTR_S pstCCMAttr;
	HI_MPI_ISP_GetCCMAttr(IspDev, &pstCCMAttr);
	pstCCMAttr.stAuto.u16HighColorTemp = pdata->u16HighColorTemp;
	pstCCMAttr.stAuto.u16MidColorTemp = pdata->u16MidColorTemp;
	pstCCMAttr.stAuto.u16LowColorTemp = pdata->u16LowColorTemp;
	memcpy(&(pstCCMAttr.stAuto.au16HighCCM),&(pdata->au16HighCCM),9*2);
	memcpy(&(pstCCMAttr.stAuto.au16MidCCM),&(pdata->au16MidCCM),9*2);
	memcpy(&(pstCCMAttr.stAuto.au16LowCCM),&(pdata->au16LowCCM),9*2);
	HI_MPI_ISP_SetCCMAttr(IspDev, &pstCCMAttr);

	return 0;
}

int isp_ccm_get(CCM_DATA *pdata)
{
	ISP_DEV IspDev = 0;

	ISP_SATURATION_ATTR_S pstSatAttr;
	HI_MPI_ISP_GetSaturationAttr(IspDev, &pstSatAttr);
	pdata->bSatManualEnable = pstSatAttr.enOpType;
	pdata->u8SatTarget = pstSatAttr.stManual.u8Saturation;
	memcpy(pdata->au8Sat, pstSatAttr.stAuto.au8Sat, 16);

	//HI_U32 pu32Value;
	//HI_MPI_ISP_GetSaturation(&pu32Value);
	//pdata->pu32Value = pu32Value;

	ISP_COLORMATRIX_ATTR_S pstCCMAttr;
	HI_MPI_ISP_GetCCMAttr(IspDev, &pstCCMAttr);
	pdata->u16HighColorTemp = pstCCMAttr.stAuto.u16HighColorTemp;
	pdata->u16LowColorTemp = pstCCMAttr.stAuto.u16LowColorTemp;
	pdata->u16MidColorTemp = pstCCMAttr.stAuto.u16MidColorTemp;
	memcpy(&(pdata->au16HighCCM),&(pstCCMAttr.stAuto.au16HighCCM),9*2);
	memcpy(&(pdata->au16MidCCM),&(pstCCMAttr.stAuto.au16MidCCM),9*2);
	memcpy(&(pdata->au16LowCCM),&(pstCCMAttr.stAuto.au16LowCCM),9*2);

	return 0;
}


